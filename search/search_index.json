{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"SSO &amp; Spring  : cr\u00e9ez une authentification centralis\u00e9e de A \u00e0 Z","text":""},{"location":"#sequence-0","title":"S\u00e9quence 0","text":"<p>Vid\u00e9o d\u2019introduction pr\u00e9sentant l\u2019\u00e9quipe, le sujet du cours, le d\u00e9roul\u00e9 g\u00e9n\u00e9ral et les objectifs p\u00e9dagogiques</p>"},{"location":"#sequence-1","title":"S\u00e9quence 1","text":"<p>QCM d\u2019\u00e9valuation (test de positionnement) sur les bases de Java, Spring...</p> <p>Rappels des fondamentaux Java : syntaxe, classes, m\u00e9thodes, types...</p>"},{"location":"#sequence-2","title":"S\u00e9quence 2","text":"<p>Docker : Installation et configuration de Docker</p> <p>Cr\u00e9ation d\u2019un projet Spring Boot</p>"},{"location":"#sequence-3","title":"S\u00e9quence 3","text":"<p>Structuration du projet : MVC, packages, d\u00e9pendances</p> <p>Introduction \u00e0 Hibernate &amp; Liquibase</p> <p>\u00c9valutation de mi-parcours</p> <p>Cr\u00e9ation de la couche DTO &amp; Service : entit\u00e9s, repositories, services, DTO, mappers</p> <p>Mise en place de Spring Security &amp; de JWT</p> <p>Cr\u00e9ation du service et du controller d\u2019authentification</p>"},{"location":"#sequence-4","title":"S\u00e9quence 4","text":"<p>Modification de l'authentication : Modification du service d'authentification pour g\u00e9rer les connexions clients.</p> <p>Application Administrative : Cr\u00e9ation d'une application web connect\u00e9e au SSO</p> <p>Application Client : Cr\u00e9ation d\u2019un client web React consommant le SSO</p> <p>Conclusion et perspectives</p>"},{"location":"sequences/s0/","title":"SSO &amp; Spring  : cr\u00e9ez une authentification centralis\u00e9e de A \u00e0 Z","text":"<p>Bienvenue dans ce cours o\u00f9 l\u2019objectif est de mettre en place une application oauth2 s\u00e9curis\u00e9e, autrement dit un SSO (single sign-on).</p> <p>Vous serez accompagn\u00e9s par :</p> <ul> <li> <p>Mathys Farineau</p> </li> <li> <p>Alan Sapet</p> </li> <li> <p>L\u00e9o Deroin</p> </li> </ul>"},{"location":"sequences/s0/#objectifs-du-cours","title":"Objectifs du cours","text":"<p>\u00c0 la fin du cours, vous serez capables de :</p> <ul> <li>D\u00e9velopper une application backend compl\u00e8te avec Spring Boot</li> <li>G\u00e9rer une base de donn\u00e9es MySQL avec Hibernate</li> <li>Mettre en place une authentification s\u00e9curis\u00e9e avec Spring Security et OAuth2 (SSO)</li> </ul>"},{"location":"sequences/s0/#contenu","title":"Contenu","text":"<p>Voici les grandes \u00e9tapes que nous allons suivre ensemble :</p> <ol> <li>Revoir les bases de Java pour partir sur de bonnes fondations</li> <li>Installer et configurer Docker</li> <li>Cr\u00e9er un projet Spring Boot et structurer l\u2019architecture</li> <li>Travailler avec une base de donn\u00e9es MySQL avec Hibernate</li> <li>S\u00e9curiser l\u2019application avec Spring Security et ajouter un SSO</li> <li>Connecter l\u2019application au frontend (React ou Vue.js)</li> <li>Exercices pratiques, un QCM final et un mini-projet pour valider les acquis</li> </ol>"},{"location":"sequences/s0/#outils","title":"Outils","text":"<p>Pendant la formation, nous allons utiliser :</p> <ul> <li>IntelliJ IDEA pour coder en Java</li> <li>Docker pour g\u00e9rer nos environnements</li> <li>GitHub pour versionner et partager le code</li> <li>Postman pour tester les API (si besoin)</li> </ul>"},{"location":"sequences/s1/fondamentaux/java/","title":"Introduction \u00e0 Java","text":"<p>Java est un langage de programmation orient\u00e9 objet, cr\u00e9\u00e9 en 1995 par James Gosling chez Sun Microsystems (aujourd\u2019hui propri\u00e9t\u00e9 d\u2019Oracle). Son slogan est \"Write once, run anywhere\" (\u00c9cris une fois, ex\u00e9cute partout).</p> <p>Aujourd\u2019hui, Java est surtout utilis\u00e9 dans :</p> <ul> <li>Les applications d\u2019entreprise (banques, assurances, e-commerce\u2026)</li> <li>Le d\u00e9veloppement web (via Spring, Jakarta EE\u2026)</li> <li>Les applications mobiles Android</li> <li>Certains syst\u00e8mes embarqu\u00e9s et logiciels bureautiques</li> </ul> <p>Contrairement \u00e0 des langages compil\u00e9s directement en langage machine (comme le C ou le C++), Java passe par une \u00e9tape interm\u00e9diaire :</p> <ol> <li>Le code source est compil\u00e9 en bytecode</li> <li>Ce bytecode est ensuite ex\u00e9cut\u00e9 par la JVM (Java Virtual Machine)</li> </ol> <p>Ainsi programme \u00e9crit une fois peut tourner sur Windows, Linux, macOS, Android\u2026 sans modification.</p>"},{"location":"sequences/s1/fondamentaux/java/#syntaxe-de-base-en-java","title":"Syntaxe de base en Java","text":""},{"location":"sequences/s1/fondamentaux/java/#structure-minimale-dun-programme-java","title":"Structure minimale d\u2019un programme Java","text":"<pre><code>public class Main {\n    public static void main(String[] args) {\n        System.out.println(\"Hello, world!\");\n    }\n}\n</code></pre> <ul> <li><code>public class Main</code> -&gt; D\u00e9claration d\u2019une classe (ici, la classe <code>Main</code>)</li> <li><code>public static void main(String[] args)</code> -&gt; Point d\u2019entr\u00e9e du programme Java</li> <li><code>System.out.println()</code> -&gt; Affiche du texte dans la console</li> </ul>"},{"location":"sequences/s1/fondamentaux/java/#detail-de-la-methode-main","title":"D\u00e9tail de la m\u00e9thode <code>main</code>","text":"<p>Explication de la ligne :</p> <pre><code>public static void main(String[] args)\n</code></pre> <ul> <li> <p><code>public</code> : c\u2019est un modificateur d\u2019acc\u00e8s.   Cela signifie que la m\u00e9thode <code>main</code> est accessible partout (y compris par la JVM lorsqu\u2019elle d\u00e9marre le programme).</p> </li> <li> <p><code>static</code> : cela indique que la m\u00e9thode appartient \u00e0 la classe et non \u00e0 un objet sp\u00e9cifique.   Autrement dit, on peut ex\u00e9cuter <code>main</code> sans cr\u00e9er d\u2019instance de la classe <code>Main</code>.</p> </li> <li> <p><code>void</code> : c\u2019est le type de retour de la m\u00e9thode.   Ici, <code>void</code> signifie que la m\u00e9thode ne retourne rien.</p> </li> <li> <p><code>String[] args</code> : param\u00e8tre de la m\u00e9thode, qui correspond \u00e0 un tableau de cha\u00eenes de caract\u00e8res.   Il permet de passer des arguments au programme depuis la ligne de commande.</p> </li> </ul>"},{"location":"sequences/s1/fondamentaux/java/#variables-et-types","title":"Variables et types","text":"<p>Java est un langage fortement typ\u00e9 et statiquement typ\u00e9, cela signifie que chaque variable doit avoir un type d\u00e9fini \u00e0 la compilation, et ce type ne peut pas changer ensuite.</p> <p>Voici quelques exemples de d\u00e9claration de variables en Java :</p> <pre><code>int age = 21;          // entier\ndouble poids = 75.5;   // nombre \u00e0 virgule flottante\nboolean isActive = true; // bool\u00e9en\nString nom = \"Jean\";   // cha\u00eene de caract\u00e8res\n</code></pre> <p>Java fournit des types primitifs int\u00e9gr\u00e9s au langage, qui repr\u00e9sentent les valeurs les plus simples.</p> <p>Exemples :</p> <ul> <li><code>int</code> -&gt; nombre entier (ex : 42)</li> <li><code>double</code> -&gt; nombre d\u00e9cimal (ex : 3.14)</li> <li><code>boolean</code> -&gt; valeur logique (true / false)</li> <li><code>char</code> -&gt; un seul caract\u00e8re (ex : <code>'A'</code>)</li> </ul> <p>\u00c0 c\u00f4t\u00e9 des primitifs, Java propose aussi des classes qui servent de types. Exemple :</p> <ul> <li><code>String</code> -&gt; repr\u00e9sente une cha\u00eene de caract\u00e8res (ex : <code>\"Bonjour\"</code>)</li> </ul>"},{"location":"sequences/s1/fondamentaux/java/#conditions","title":"Conditions","text":"<pre><code>int age = 18;\n\nif (age &gt;= 18) {\n    System.out.println(\"Majeur\");\n} else {\n    System.out.println(\"Mineur\");\n}\n</code></pre> <p>On peut tester plusieurs cas diff\u00e9rents gr\u00e2ce \u00e0 <code>else if</code> :</p> <pre><code>int note = 15;\n\nif (note &gt;= 16) {\n    System.out.println(\"Tr\u00e8s bien\");\n} else if (note &gt;= 12) {\n    System.out.println(\"Assez bien\");\n} else if (note &gt;= 10) {\n    System.out.println(\"Passable\");\n} else {\n    System.out.println(\"\u00c9chec\");\n}\n</code></pre> <p>Pour les cas simples, on peut utiliser l\u2019op\u00e9rateur ternaire <code>? :</code> :</p> <pre><code>int age = 20;\nString statut = (age &gt;= 18) ? \"Majeur\" : \"Mineur\";\nSystem.out.println(statut);\n</code></pre>"},{"location":"sequences/s1/fondamentaux/java/#boucles","title":"Boucles","text":"<p>La boucle <code>for</code> est utilis\u00e9e lorsqu\u2019on sait \u00e0 l\u2019avance combien de fois on veut r\u00e9p\u00e9ter une action.</p> <pre><code>for (int i = 0; i &lt; 5; i++) {\n    System.out.println(\"i = \" + i);\n}\n</code></pre> <p>D\u00e9composition :</p> <ul> <li><code>int i = 0</code> -&gt; initialisation (variable de d\u00e9part)</li> <li><code>i &lt; 5</code> -&gt; condition de poursuite</li> <li><code>i++</code> -&gt; incr\u00e9mentation \u00e0 chaque tour</li> </ul> <p>Ici, le programme affiche <code>i</code> de 0 \u00e0 4.</p> <p>La boucle <code>while</code> s\u2019ex\u00e9cute tant que la condition est vraie.</p> <pre><code>int j = 0;\nwhile (j &lt; 5) {\n    System.out.println(\"j = \" + j);\n    j++;\n}\n</code></pre> <p>Ici, la boucle continue tant que <code>j &lt; 5</code>.</p> <p>Le parcours de collection</p> <pre><code>String[] fruits = {\"Pomme\", \"Banane\", \"Orange\"};\n\nfor (String fruit : fruits) {\n    System.out.println(fruit);\n}\n</code></pre> <p>Ici, la boucle parcourt chaque \u00e9l\u00e9ment du tableau sans se soucier de l\u2019index.</p>"},{"location":"sequences/s1/fondamentaux/poo/","title":"La Programmation Orient\u00e9e Objet (POO)","text":"<p>Java est un langage orient\u00e9 objet. Cela signifie que l\u2019on structure le code \u00e0 l\u2019aide de classes et d\u2019objets (les instances de ces classes). La POO permet de mieux organiser le code, de le rendre r\u00e9utilisable, et de repr\u00e9senter des concepts r\u00e9els.</p>"},{"location":"sequences/s1/fondamentaux/poo/#les-concepts","title":"Les concepts","text":"<ul> <li> <p>Classe   Une classe est un mod\u00e8le qui d\u00e9finit des propri\u00e9t\u00e9s (attributs) et des comportements (m\u00e9thodes).   Exemple : une classe <code>Car</code> repr\u00e9sente l\u2019id\u00e9e g\u00e9n\u00e9rale d\u2019une voiture.</p> </li> <li> <p>Objet   Un objet est une instance concr\u00e8te d\u2019une classe.   Exemple : <code>Car myCar = new Car(new Brand(\"Renault\", \"France\"), 2020);</code> cr\u00e9e une voiture sp\u00e9cifique.</p> </li> <li> <p>Attributs   Ce sont les variables qui appartiennent \u00e0 une classe et d\u00e9crivent ses caract\u00e9ristiques.   Exemple : une voiture a une <code>marque</code> et une <code>ann\u00e9e</code>.</p> </li> <li> <p>Constructeur   C\u2019est une m\u00e9thode sp\u00e9ciale qui permet d\u2019initialiser un objet au moment de sa cr\u00e9ation.   Exemple : <code>new Car(new Brand(\"Renault\", \"France\"), 2020);</code> appelle le constructeur de <code>Car</code>.</p> </li> <li> <p>M\u00e9thodes   Ce sont les actions qu\u2019un objet peut effectuer. Elles d\u00e9crivent le comportement.   Exemple : <code>displayInfo()</code> permet d\u2019afficher les informations d\u2019une voiture.</p> </li> <li> <p>Encapsulation   On utilise souvent le mot-cl\u00e9 <code>private</code> pour prot\u00e9ger les attributs, et on fournit des getters et setters pour y acc\u00e9der ou les modifier en toute s\u00e9curit\u00e9.</p> </li> </ul>"},{"location":"sequences/s1/fondamentaux/poo/#exemple-de-classes-et-objets","title":"Exemple de classes et objets","text":"<pre><code>public class Brand {\n    // Attributes\n    private String name;\n    private String country;\n\n    // Constructor\n    public Brand(String name, String country) {\n        this.name = name;\n        this.country = country;\n    }\n\n    // Getters and setters\n    public String getName() {\n        return name;\n    }\n\n    public void setName(String name) {\n        this.name = name;\n    }\n\n    public String getCountry() {\n        return country;\n    }\n\n    public void setCountry(String country) {\n        this.country = country;\n    }\n\n    // toString method\n    @Override\n    public String toString() {\n        return name + \" (\" + country + \")\";\n    }\n}\n\npublic class Car {\n    // Attributes\n    private Brand brand;\n    private int year;\n\n    // Constructor\n    public Car(Brand brand, int year) {\n        this.brand = brand;\n        this.year = year;\n    }\n\n    // Getters and setters\n    public Brand getBrand() {\n        return brand;\n    }\n\n    public void setBrand(Brand brand) {\n        this.brand = brand;\n    }\n\n    public int getYear() {\n        return year;\n    }\n\n    public void setYear(int year) {\n        this.year = year;\n    }\n\n    // Method\n    public void displayInfo() {\n        System.out.println(\"Car: \" + brand.toString() + \", Year: \" + year);\n    }\n}\n</code></pre>"},{"location":"sequences/s1/fondamentaux/poo/#utilisation-des-classes","title":"Utilisation des classes","text":"<pre><code>public class Main {\n    public static void main(String[] args) {\n        Brand renault = new Brand(\"Renault\", \"France\");\n        Car clio = new Car(renault, 2020);\n\n        clio.displayInfo(); \n        // Output: Car: Renault (France), Year: 2020\n    }\n}\n</code></pre>"},{"location":"sequences/s1/fondamentaux/poo/#packages","title":"Packages","text":"<p>Un package permet d\u2019organiser et ranger les classes dans un projet. La diff\u00e9rence avec un dossier classique est que le package fait partie du nom complet de la classe, ainsi on \u00e9vite les conflits de noms.</p> <pre><code>package com.fyc.sso;\n\npublic class User {\n    private String name;\n\n    public User(String name) {\n        this.name = name;\n    }\n\n    public String getName() {\n        return name;\n    }\n\n    public void setName(String name) {\n        this.name = name;\n    }\n}\n</code></pre>"},{"location":"sequences/s1/fondamentaux/poo/#exercice-pratique-30-min-gestion-dune-bibliotheque","title":"Exercice pratique (30 min) : Gestion d\u2019une biblioth\u00e8que","text":"<p>Dans cet exercice, vous allez cr\u00e9er un petit syst\u00e8me pour g\u00e9rer une biblioth\u00e8que, en utilisant les concepts de POO : classes, objets, attributs et m\u00e9thodes.</p>"},{"location":"sequences/s1/fondamentaux/poo/#etapes","title":"\u00c9tapes","text":"<ol> <li> <p>Cr\u00e9er une classe <code>Author</code></p> <ul> <li>Attributs :<ul> <li><code>name</code> (String) -&gt; nom de l\u2019auteur</li> <li><code>country</code> (String) -&gt; pays d\u2019origine</li> </ul> </li> <li>M\u00e9thodes :<ul> <li>Constructeur</li> <li>Getters et setters</li> <li><code>toString()</code> -&gt; retourne <code>\"name (country)\"</code></li> </ul> </li> </ul> </li> <li> <p>Cr\u00e9er une classe <code>Book</code></p> <ul> <li>Attributs :<ul> <li><code>title</code> (String) -&gt; titre du livre</li> <li><code>author</code> (Author) -&gt; auteur du livre</li> <li><code>year</code> (int) -&gt; ann\u00e9e de publication</li> </ul> </li> <li>M\u00e9thodes :<ul> <li>Constructeur</li> <li>Getters et setters</li> <li><code>displayInfo()</code> -&gt; affiche <code>\"Title: &lt;title&gt;, Author: &lt;author&gt;, Year: &lt;year&gt;\"</code></li> </ul> </li> </ul> </li> <li> <p>Cr\u00e9er une classe <code>Library</code></p> <ul> <li>Attributs :<ul> <li><code>name</code> (String) -&gt; nom de la biblioth\u00e8que</li> <li><code>books</code> (ArrayList) -&gt; liste des livres <li>M\u00e9thodes :<ul> <li><code>addBook(Book book)</code> -&gt; ajoute un livre \u00e0 la liste</li> <li><code>removeBook(Book book)</code> -&gt; supprime un livre \u00e0 la liste</li> <li><code>displayBooks()</code> -&gt; affiche tous les livres</li> <li><code>findBooksByAuthor(String authorName)</code> -&gt; affiche tous les livres d\u2019un auteur donn\u00e9</li> <li>Bonus : <code>findBooksAfterYear(int year)</code> -&gt; affiche les livres publi\u00e9s apr\u00e8s une certaine ann\u00e9e</li> </ul> </li>"},{"location":"sequences/s1/fondamentaux/poo/#classe-main-attendu","title":"Classe Main attendu","text":"<pre><code>public class Main {\n    public static void main(String[] args) {\n        Author rowling = new Author(\"J.K. Rowling\", \"UK\");\n        Author orwell = new Author(\"George Orwell\", \"UK\");\n\n        Book hpOne = new Book(\"Harry Potter and the Philosopher's Stone\", rowling, 1997);\n        Book hpTwo = new Book(\"Harry Potter and the Chamber of Secrets\", rowling, 1998);\n        Book nineteenEightyFour = new Book(\"1984\", orwell, 1949);\n\n        Library myLibrary = new Library(\"My Super Library\");\n\n        myLibrary.addBook(hpOne);\n        myLibrary.addBook(hpTwo);\n        myLibrary.addBook(nineteenEightyFour);\n\n        myLibrary.displayBooks();\n\n        ArrayList&lt;Book&gt; booksFromJK = myLibrary.findBooksByAuthor(\"J.K. Rowling\");\n        booksFromJK.forEach(book -&gt; System.out.println(book.displayInfos()));\n\n        ArrayList&lt;Book&gt; booksAfterX = myLibrary.findBooksAfterYear(2000);\n        booksAfterX.forEach(book -&gt; System.out.println(book.displayInfos()));\n    }\n}\n</code></pre>"},{"location":"sequences/s1/fondamentaux/poo/#correction","title":"Correction","text":"<p>Pour vous aider, voici la documentation officielle de Java sur la POO :</p> <ul> <li>Classes et objets</li> <li>Packages</li> </ul>"},{"location":"sequences/s1/positionnement/","title":"Test de positionnement","text":"<p>Avant de commencer ce cours, nous vous proposons un petit test de positionnement. Il comprend des questions de diff\u00e9rents niveaux de difficult\u00e9 \u00e0 travers 50 questions sur Java, Java Spring et Docker. Vous avez 1h pour le compl\u00e9ter. Chaque question rapporte 1 point. A la fin du test, vous obtiendrez un score sur 50. Si vous obtenez un score sup\u00e9rieur ou \u00e9gal \u00e0 40, vous pouvez passer directement au module 2 m\u00eame si nous vous le d\u00e9conseillons.</p> <p>Ce test n'est pas not\u00e9 et n'a pas d'impact sur votre progression dans le cours. Il est l\u00e0 pour vous aider \u00e0 \u00e9valuer votre niveau et \u00e0 identifier les domaines dans lesquels vous pourriez avoir besoin de vous am\u00e9liorer.</p> <p>\u26a0\ufe0f Ce test est \u00e0 faire une seule fois. Si vous le refaites, votre score ne sera pas pris en compte. Bonne chance !</p> <p>Acc\u00e9der au formulaire de positionnement</p>"},{"location":"sequences/s2/docker/","title":"Introduction \u00e0 Docker","text":"<p>Docker est une plateforme de conteneurisation qui permet d'encapsuler une application et ses d\u00e9pendances dans un environnement portable et reproductible. Dans cette s\u00e9quence, l'objectif est de comprendre les principes de base de Docker et d'apprendre \u00e0 construire, ex\u00e9cuter et orchestrer des conteneurs pour des applications Java/Spring Boot.</p>"},{"location":"sequences/s2/docker/#pourquoi-utiliser-docker","title":"Pourquoi utiliser Docker ?","text":"<ul> <li>Isolation des d\u00e9pendances : chaque application s'ex\u00e9cute dans son propre conteneur.</li> <li>Portabilit\u00e9 : m\u00eame comportement entre postes de d\u00e9veloppement, CI et production.</li> <li>Rapidit\u00e9 de d\u00e9ploiement : d\u00e9marrage et mise \u00e0 l'\u00e9chelle simplifi\u00e9s.</li> <li>Coh\u00e9rence : m\u00eame image = m\u00eame comportement.</li> </ul>"},{"location":"sequences/s2/docker/#concepts-cles","title":"Concepts cl\u00e9s","text":"<ul> <li>Image : snapshot immuable contenant l'application et son environnement.</li> <li>Conteneur : instance en cours d'ex\u00e9cution d'une image.</li> <li>Dockerfile : fichier d\u00e9claratif d\u00e9crivant comment construire une image.</li> <li>Registry : d\u00e9p\u00f4t d'images (ex. Docker Hub, registry priv\u00e9e).</li> <li>Volumes : stockage persistant pour les conteneurs.</li> <li>R\u00e9seaux : connectivit\u00e9 entre conteneurs et services.</li> </ul>"},{"location":"sequences/s2/docker/#objectifs-de-la-sequence","title":"Objectifs de la s\u00e9quence","text":"<p>\u00c0 la fin de ce module, vous serez capable de :</p> <ul> <li>Expliquer les principaux concepts de Docker.</li> <li>\u00c9crire un <code>Dockerfile</code> simple pour une application Spring Boot.</li> <li>Construire et tester une image Docker localement.</li> <li>Utiliser <code>docker compose</code> pour ex\u00e9cuter des services li\u00e9s.</li> </ul>"},{"location":"sequences/s2/docker/#prerequis","title":"Pr\u00e9requis","text":"<ul> <li>Docker install\u00e9 (Engine et Docker CLI).  <p>V\u00e9rifier avec : <code>docker --version</code>.</p> </li> <li>Docker Compose pour orchestrer plusieurs services.</li> </ul>"},{"location":"sequences/s2/docker/#ressources-recommandees","title":"Ressources recommand\u00e9es","text":"<ul> <li>Documentation Docker : https://docs.docker.com</li> <li>Tutoriels officiels et exemples pour Java/Spring Boot</li> <li>Exemples pratiques fournis dans la suite de la s\u00e9quence</li> </ul>"},{"location":"sequences/s2/docker/#exercices-pratiques","title":"Exercices pratiques","text":"<ol> <li>Installer Docker et v\u00e9rifier son bon fonctionnement.</li> <li>Cr\u00e9er un projet avec 2 services (phpmyadmin + mariadb) en utilisant Docker Compose.</li> </ol>"},{"location":"sequences/s2/docker/#correction","title":"Correction","text":""},{"location":"sequences/s2/docker/installation/","title":"Installation de Docker (Linux / Windows)","text":"<p>Vous trouverez sur cette page les m\u00e9thodes pour installer Docker et Docker Compose sur Linux et Windows, v\u00e9rifications et \u00e9tapes post\u2011installation adapt\u00e9es \u00e0 des projets Java / Spring Boot.</p> <p>Cette page couvre les deux syst\u00e8mes d'exploitation les plus courants. Pour macOS, r\u00e9f\u00e9rez-vous \u00e0 la documentation officielle Docker.</p>"},{"location":"sequences/s2/docker/installation/#verifications-prealables","title":"V\u00e9rifications pr\u00e9alables","text":"<ul> <li>V\u00e9rifier Docker apr\u00e8s installation :</li> <li><code>docker --version</code></li> <li><code>docker compose version</code></li> <li>Test rapide : <code>docker run --rm hello-world</code></li> </ul>"},{"location":"sequences/s2/docker/installation/#1-installation-linux-ex-debian-ubuntu","title":"1. Installation \u2014 Linux (ex. Debian / Ubuntu)","text":"<ol> <li>Mettre \u00e0 jour et installer les d\u00e9pendances :</li> <li> <p><code>sudo apt update &amp;&amp; sudo apt install -y ca-certificates curl gnupg lsb-release</code></p> </li> <li> <p>Ajouter le repository officiel Docker :</p> </li> <li><code>sudo mkdir -p /etc/apt/keyrings</code></li> <li><code>curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmour -o /etc/apt/keyrings/docker.gpg</code></li> <li> <p><code>echo \"deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable\" | sudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null</code></p> </li> <li> <p>Installer Docker Engine et le plugin Compose :</p> </li> <li><code>sudo apt update</code></li> <li> <p><code>sudo apt install -y docker-ce docker-ce-cli containerd.io docker-compose-plugin</code></p> </li> <li> <p>Activer et d\u00e9marrer le service :</p> </li> <li> <p><code>sudo systemctl enable --now docker</code></p> </li> <li> <p>(Optionnel mais recommand\u00e9) Ajouter l'utilisateur au groupe <code>docker</code> pour utiliser Docker sans <code>sudo</code> :</p> </li> <li><code>sudo usermod -aG docker $USER</code></li> <li> <p>Se d\u00e9connecter / reconnecter ou ex\u00e9cuter <code>newgrp docker</code></p> </li> <li> <p>V\u00e9rifier :</p> </li> <li><code>docker --version</code></li> <li><code>docker compose version</code></li> <li><code>docker run --rm hello-world</code></li> </ol> <p>Notes :</p> <ul> <li>Pour d'autres distributions Linux (RHEL, Arch, etc.), suivre la documentation officielle Docker.</li> <li>Sur autres distros (Fedora, CentOS), utiliser la documentation officielle Docker sp\u00e9cifique \u00e0 la distribution.</li> </ul>"},{"location":"sequences/s2/docker/installation/#2-installation-windows-docker-desktop","title":"2. Installation \u2014 Windows (Docker Desktop)","text":"<p>Pr\u00e9requis : - Windows 10 64\u2011bits: \u00e9dition Pro, Enterprise ou Education (ou Windows 11). - Activer la virtualisation; WSL2 recommand\u00e9 pour de meilleures performances.</p> <ol> <li>Installer WSL2 (recommand\u00e9) :</li> <li>Ouvrir PowerShell en administrateur et ex\u00e9cuter :<ul> <li><code>wsl --install</code> (Windows 10/11 r\u00e9cent) ou suivre la doc Microsoft si besoin.</li> </ul> </li> <li> <p>Installer une distribution (ex. Ubuntu) depuis le Microsoft Store.</p> </li> <li> <p>T\u00e9l\u00e9charger et installer Docker Desktop :</p> </li> <li>T\u00e9l\u00e9charger depuis : https://docs.docker.com/desktop/</li> <li> <p>Pendant l'installation, activer l'int\u00e9gration WSL2 si propos\u00e9e.</p> </li> <li> <p>Configuration post\u2011installation :</p> </li> <li>Lancer Docker Desktop, v\u00e9rifier que le moteur est d\u00e9marr\u00e9.</li> <li>Dans les Settings, activer l'int\u00e9gration avec la distribution WSL utilis\u00e9e (ex. Ubuntu).</li> <li> <p>Ajuster m\u00e9moire/proc si n\u00e9cessaire pour Spring Boot (Resources &gt; Advanced).</p> </li> <li> <p>V\u00e9rifier depuis PowerShell ou WSL :</p> </li> <li><code>docker --version</code></li> <li><code>docker compose version</code></li> <li><code>docker run --rm hello-world</code></li> <li>Depuis WSL (recommand\u00e9 pour dev) : <code>docker run --rm hello-world</code></li> </ol> <p>Notes :</p> <ul> <li>Docker Desktop inclut Docker Engine et Docker Compose (plugin).</li> <li>Si vous \u00eates sur Windows Home plus ancien, WSL2 est obligatoire. Pour environnements serveur sans Docker Desktop, utiliser la version Windows Server / MobyEngine (cas avanc\u00e9).</li> </ul>"},{"location":"sequences/s2/docker/installation/#ressources","title":"Ressources","text":"<ul> <li>Documentation Docker : https://docs.docker.com</li> <li>Guide d'installation Docker Desktop : https://docs.docker.com/desktop/</li> <li>Guide WSL2 : https://learn.microsoft.com/windows/wsl</li> </ul>"},{"location":"sequences/s2/init_projet/creation_archi/","title":"Cr\u00e9ation de l\u2019architecture","text":""},{"location":"sequences/s2/init_projet/creation_archi/#arborescence-du-projet","title":"Arborescence du projet","text":"<p>Une fois que l'application Spring Boot est cr\u00e9\u00e9e, il est important de structurer le projet selon le mod\u00e8le MVC.  Voici l'arborescence que nous allons mettre en place :</p> <pre><code>app/\n\u251c\u2500\u2500 src/\n\u2502   \u251c\u2500\u2500 main/\n\u2502   \u2502   \u251c\u2500\u2500 java/\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 com/example/app/\n\u2502   \u2502   \u2502       \u251c\u2500\u2500 controller/\n\u2502   \u2502   \u2502       \u251c\u2500\u2500 model/\n\u2502   \u2502   \u2502       \u251c\u2500\u2500 repository/\n\u2502   \u2502   \u2502       \u2514\u2500\u2500 service/\n\u2502   \u2502   \u2514\u2500\u2500 resources/\n\u2502   \u2502       \u2514\u2500\u2500 db.changelog/\n\u2502   \u2502         \u2514\u2500\u2500 app-changelog.xml\n\u2502   \u2502       \u251c\u2500\u2500 static/\n\u2502   \u2502       \u251c\u2500\u2500 template/\n\u2502   \u2502       \u2514\u2500\u2500 application.properties\n\u2514\u2500\u2500 pom.xml\n</code></pre>"},{"location":"sequences/s2/init_projet/creation_archi/#description-des-dossiers","title":"Description des dossiers","text":"<ul> <li><code>controller/</code> : Contient les classes qui g\u00e8rent les requ\u00eates HTTP et les interactions entre le mod\u00e8le et la vue.</li> <li><code>model/</code> : Contient les classes repr\u00e9sentant les entit\u00e9s de l'application, ainsi que la logique m\u00e9tier.</li> <li><code>repository/</code> : Contient les interfaces qui g\u00e8rent la persistance des donn\u00e9es (CRUD) en interagissant avec la base de donn\u00e9es.</li> <li><code>service/</code> : Contient les classes qui impl\u00e9mentent la logique m\u00e9tier et les r\u00e8gles de gestion.</li> <li><code>resources/db.changelog/</code> : Contient les fichiers de migration de la base de donn\u00e9es (Liquibase).</li> <li><code>resources/static/</code> : Contient les ressources statiques (CSS, JS, images).</li> <li><code>application.properties</code> : Fichier de configuration de l'application.</li> <li><code>pom.xml</code> : Fichier de configuration Maven pour g\u00e9rer les d\u00e9pendances et les plugins.</li> </ul>"},{"location":"sequences/s2/init_projet/creation_projet/","title":"Initialisation du projet avec Spring Initializr","text":"<p>Pour d\u00e9marrer notre projet Spring Boot, nous allons utiliser Spring Initializr, un outil en ligne qui facilite la cr\u00e9ation de projets Spring Boot avec les d\u00e9pendances n\u00e9cessaires.</p> <p>Lien vers Spring Initializr : https://start.spring.io/</p> <p>Voici les \u00e9tapes \u00e0 suivre pour cr\u00e9er notre projet :</p>"},{"location":"sequences/s2/init_projet/dockerisation/","title":"Dockerisation du projet Spring Boot","text":"<p>Dans cette partie, vous apprendrez \u00e0 dockeriser une application Spring Boot avec une base de donn\u00e9es MariaDB, en utilisant Docker Compose pour orchestrer les services. Vous verrez comment configurer les fichiers Docker, g\u00e9rer les variables d'environnement et lancer l'application en mode d\u00e9veloppement et production.</p>"},{"location":"sequences/s2/init_projet/dockerisation/#role-des-fichiers","title":"R\u00f4le des fichiers","text":""},{"location":"sequences/s2/init_projet/dockerisation/#dockerfile","title":"<code>Dockerfile</code>","text":"<ul> <li>Multi-stage build : utilise une image Maven pour compiler le projet et produire le jar, puis une image JDK l\u00e9g\u00e8re pour ex\u00e9cuter l'application.</li> <li>Avantage : image finale plus l\u00e9g\u00e8re, compilation isol\u00e9e.</li> <li>Points importants : ARG/ENV pour le JAR, <code>ENTRYPOINT</code> passe <code>JAVA_OPTS</code>.</li> </ul>"},{"location":"sequences/s2/init_projet/dockerisation/#docker-composeyml-productionstack-complet","title":"<code>docker-compose.yml</code> (production/stack complet)","text":"<ul> <li>D\u00e9finit trois services : <code>db</code> (MariaDB), <code>app</code> (image build\u00e9e depuis <code>Dockerfile</code>) et <code>phpmyadmin</code>.</li> <li>Utilise <code>env_file: - .env</code> pour centraliser les secrets/config.</li> <li>Monte un volume <code>db_data</code> pour la persistance des donn\u00e9es.</li> <li><code>app</code> d\u00e9pend de <code>db</code> avec <code>depends_on</code>.</li> <li>Mappe le port application via la variable <code>SERVER_PORT</code> et expose <code>3306</code> pour la DB.</li> </ul>"},{"location":"sequences/s2/init_projet/dockerisation/#docker-composedevyml-dev","title":"<code>docker-compose.dev.yml</code> (dev)","text":"<ul> <li>Contient uniquement <code>db</code> (MariaDB) pour que l'application soit lanc\u00e9e depuis l'IDE mais connect\u00e9e \u00e0 une base dockeris\u00e9e.</li> <li>Utiliser en dev quand on veut debug depuis IntelliJ et garder la DB isol\u00e9e.</li> </ul>"},{"location":"sequences/s2/init_projet/dockerisation/#dockerignore","title":"<code>.dockerignore</code>","text":"<ul> <li>Exclut les fichiers inutiles du contexte de build Docker (ex : <code>target/</code>, <code>.git/</code>, etc.) pour acc\u00e9l\u00e9rer la construction de l'image.</li> </ul>"},{"location":"sequences/s2/init_projet/dockerisation/#variables-importantes-dans-env","title":"Variables importantes (dans <code>.env</code>)","text":"<ul> <li><code>MARIADB_DATABASE</code>, <code>MARIADB_USER</code>, <code>MARIADB_PASSWORD</code>, <code>MARIADB_ROOT_PASSWORD</code></li> <li><code>DATASOURCE_URL</code>, <code>DATASOURCE_USERNAME</code>, <code>DATASOURCE_PASSWORD</code> (pour Spring Boot)</li> <li><code>LIQUIBASE_CHANGE_LOG</code> (si Liquibase utilis\u00e9)</li> <li><code>SERVER_PORT</code> (port expos\u00e9 par l'application)</li> <li><code>JAVA_OPTS</code> (options JVM au runtime)</li> </ul> <p>Exemple rapide de <code>DATASOURCE_URL</code> : <code>jdbc:mariadb://db:3306/&lt;DATABASE&gt;?useSSL=false</code></p>"},{"location":"sequences/s2/init_projet/dockerisation/#commandes-utiles","title":"Commandes utiles","text":"<ul> <li> <p>Lancer la DB en dev (app depuis l'IDE) : <code>docker compose -f docker-compose.dev.yml up -d</code></p> </li> <li> <p>Lancer le stack complet (build + run) : <code>docker compose -f docker-compose.yml up --build</code></p> </li> <li> <p>Logs : <code>docker compose -f docker-compose.yml logs -f app</code></p> </li> <li> <p>Arr\u00eater et supprimer volumes : <code>docker compose -f docker-compose.yml down -v</code></p> </li> <li> <p>Inspecter conteneur DB : <code>docker compose -f docker-compose.yml exec db sh</code>   (ou utiliser <code>mysql</code> client selon image)</p> </li> </ul>"},{"location":"sequences/s2/init_projet/dockerisation/#points-de-vigilance-depannage-rapide","title":"Points de vigilance / d\u00e9pannage rapide","text":"<ul> <li>Si <code>docker</code> n\u00e9cessite <code>sudo</code>, ajouter l'utilisateur au groupe <code>docker</code> ou utiliser <code>sudo</code>.</li> <li>Si port 3306 d\u00e9j\u00e0 utilis\u00e9, adapter le mapping local dans <code>docker-compose</code> ou arr\u00eater le service local MySQL.</li> <li>Pour supprimer data corrompue : <code>docker volume rm &lt;project&gt;_db_data</code> (attention perte de donn\u00e9es).</li> <li>Erreurs de build : v\u00e9rifier que <code>pom.xml</code> et <code>src/</code> sont copi\u00e9s correctement dans le <code>Dockerfile</code>.</li> </ul>"},{"location":"sequences/s2/init_projet/dockerisation/#video-explicative","title":"Vid\u00e9o explicative","text":""},{"location":"sequences/s2/init_projet/dockerisation/#evolutions-du-code-fichiers-a-recuperer-dans-le-projet","title":"\u00c9volutions du code (fichiers \u00e0 r\u00e9cup\u00e9rer dans le projet)","text":"<ul> <li><code>Dockerfile</code></li> <li><code>docker-compose.yml</code></li> <li><code>docker-compose.dev.yml</code></li> <li><code>.env</code> (exemple \u00e0 cr\u00e9er/modifier avant d\u00e9marrage)</li> <li><code>.dockerignore</code></li> </ul> <p>Copier ces fichiers depuis le d\u00e9p\u00f4t local ou les ouvrir dans l'IDE pour modification.</p>"},{"location":"sequences/s3/auth/creation_controller/","title":"Cr\u00e9ation du controller d'authentification","text":"<p>Dans le dossier <code>controller</code>, cr\u00e9er une nouvelle classe <code>AuthController</code> avec l'annotation <code>@RestController</code> et le mapping de base <code>/api/auth</code>. De plus, ajouter l'annotation <code>@CrossOrigin</code> pour permettre les requ\u00eates cross-origin avec pour valeur <code>origins = \"*\", maxAge = 3600</code>.</p>"},{"location":"sequences/s3/auth/creation_controller/#attributs","title":"Attributs","text":"<pre><code>@Autowired\nprivate AuthService authService;\n</code></pre> <p>De toute \u00e9vidence, nous avons besoin d'injecter le service d'authentification que nous avons cr\u00e9\u00e9 pr\u00e9c\u00e9demment.</p>"},{"location":"sequences/s3/auth/creation_controller/#endpoints","title":"Endpoints","text":"<pre><code>@PostMapping(\"/register\")\n    public ResponseEntity&lt;?&gt; registerUser(@Valid @RequestBody RegisterRequest registerRequest) {\n        try {\n            MessageDTO response = authService.registerUser(registerRequest);\n            return ResponseEntity.ok(response);\n        } catch (RuntimeException e) {\n            return ResponseEntity\n                    .badRequest()\n                    .body(new MessageDTO(\"Erreur: \" + e.getMessage()));\n        }\n    }\n\n    @PostMapping(\"/login/{realm}\")\n    public ResponseEntity&lt;?&gt; loginPost(\n            @PathVariable String realm,\n            @RequestParam(value = \"client_id\", required = false) String clientId,\n            @Valid @RequestBody LoginRequest loginRequest,\n            HttpServletRequest request) {\n\n        logger.info(\"POST /api/auth/login/{} from {} - client_id='{}' - username='{}'\",\n                realm,\n                request.getRemoteAddr(),\n                clientId,\n                loginRequest.getUsername());\n\n        try {\n            AuthResponseDTO authResponse = authService.authenticateUser(loginRequest);\n\n            if (\"security-admin-console\".equals(clientId)) {\n                boolean allowed = authService.testUser(loginRequest.getUsername(), realm, clientId);\n                if (!allowed) {\n                    return ResponseEntity\n                            .status(HttpStatus.FORBIDDEN)\n                            .body(new MessageDTO(\"Utilisateur non autoris\u00e9 pour ce realm/client\"));\n                }\n            }\n\n            return ResponseEntity.ok(authResponse);\n        } catch (RuntimeException e) {\n            return ResponseEntity\n                    .status(HttpStatus.UNAUTHORIZED)\n                    .body(new MessageDTO(\"Authentification \u00e9chou\u00e9e: \" + e.getMessage()));\n        } catch (Exception e) {\n            return ResponseEntity\n                    .status(HttpStatus.UNAUTHORIZED)\n                    .body(new MessageDTO(\"Authentification \u00e9chou\u00e9e\"));\n        }\n    }\n\n    @PostMapping(\"/refresh-token\")\n    public ResponseEntity&lt;?&gt; refreshToken(@Valid @RequestBody RefreshTokenRequest request) {\n        try {\n            AuthResponseDTO response = authService.refreshToken(request.getRefreshToken());\n            return ResponseEntity.ok(response);\n        } catch (RuntimeException e) {\n            return ResponseEntity\n                    .status(HttpStatus.UNAUTHORIZED)\n                    .body(new MessageDTO(\"Erreur: \" + e.getMessage()));\n        }\n    }\n\n    @PostMapping(\"/logout\")\n    public ResponseEntity&lt;?&gt; logout() {\n        try {\n            authService.logout();\n            return ResponseEntity.ok(new MessageDTO(\"D\u00e9connexion r\u00e9ussie\"));\n        } catch (Exception e) {\n            return ResponseEntity\n                    .badRequest()\n                    .body(new MessageDTO(\"Erreur lors de la d\u00e9connexion\"));\n        }\n    }\n\n    @GetMapping(\"/validate-token\")\n    public ResponseEntity&lt;?&gt; validateToken(@RequestHeader(\"Authorization\") String token) {\n        try {\n            String jwt = token.substring(7);\n            boolean isValid = authService.validateToken(jwt);\n            if (isValid) {\n                return ResponseEntity.ok(new MessageDTO(\"Token valide\"));\n            } else {\n                return ResponseEntity\n                        .status(HttpStatus.UNAUTHORIZED)\n                        .body(new MessageDTO(\"Token invalide\"));\n            }\n        } catch (Exception e) {\n            return ResponseEntity\n                    .status(HttpStatus.UNAUTHORIZED)\n                    .body(new MessageDTO(\"Token invalide\"));\n        }\n    }\n</code></pre>"},{"location":"sequences/s3/auth/creation_controller/#explications","title":"Explications","text":""},{"location":"sequences/s3/auth/creation_controller/#registeruser","title":"registerUser","text":"<p>G\u00e8re les requ\u00eates POST \u00e0 <code>/api/auth/register</code> pour l'enregistrement des utilisateurs. Il utilise le service d'authentification pour cr\u00e9er un nouvel utilisateur et retourne un message de succ\u00e8s ou d'erreur.</p>"},{"location":"sequences/s3/auth/creation_controller/#loginpost","title":"loginPost","text":"<p>G\u00e8re les requ\u00eates POST \u00e0 <code>/api/auth/login/{realm}</code> pour l'authentification des utilisateurs. Il prend en compte le <code>realm</code> et un <code>client_id</code> optionnel. Apr\u00e8s authentification, il retourne les tokens JWT et de rafra\u00eechissement, ou un message d'erreur.</p>"},{"location":"sequences/s3/auth/creation_controller/#refreshtoken","title":"refreshToken","text":"<p>G\u00e8re les requ\u00eates POST \u00e0 <code>/api/auth/refresh-token</code> pour rafra\u00eechir le token JWT en utilisant un token de rafra\u00eechissement valide. Il retourne les nouveaux tokens ou un message d'erreur.</p>"},{"location":"sequences/s3/auth/creation_controller/#logout","title":"logout","text":"<p>G\u00e8re les requ\u00eates POST \u00e0 <code>/api/auth/logout</code> pour d\u00e9connecter l'utilisateur en effa\u00e7ant le contexte de s\u00e9curit\u00e9. Il retourne un message de succ\u00e8s ou d'erreur.</p>"},{"location":"sequences/s3/auth/creation_controller/#validatetoken","title":"validateToken","text":"<p>G\u00e8re les requ\u00eates GET \u00e0 <code>/api/auth/validate-token</code> pour valider un token JWT. Il extrait le token de l'en-t\u00eate <code>Authorization</code>, v\u00e9rifie sa validit\u00e9 et retourne un message indiquant si le token est valide ou non.</p>"},{"location":"sequences/s3/auth/creation_controller/#conclusion","title":"Conclusion","text":"<p>Si vous avez bien suivi toutes les \u00e9tapes de ce cours, vous devriez maintenant avoir un controller d'authentification complet qui g\u00e8re l'enregistrement, la connexion, le rafra\u00eechissement des tokens, la d\u00e9connexion et la validation des tokens JWT. </p> <p>Vous pouvez maintenant tester ces endpoints avec des outils comme Postman ou curl pour vous assurer qu'ils fonctionnent correctement.</p>"},{"location":"sequences/s3/auth/creation_dto/","title":"Cr\u00e9ation des DTO d\u2019authentification","text":"<p>Ici, nous allons cr\u00e9er les DTO (Data Transfer Objects) n\u00e9cessaires pour les r\u00e9ponses du service d'authentification.</p> <p>Chaque DTO doit inclure les constructeurs, getters et setters appropri\u00e9s.</p> <p>Dans le dossier <code>dto</code>, cr\u00e9er la classe <code>MessageDTO</code> avec pour attribut :</p> <pre><code>private String message;\n</code></pre> <p>Ensuite, cr\u00e9er la classe <code>AuthResponseDTO</code> avec les attributs suivants :</p> <pre><code>private String token;\nprivate String refreshToken;\nprivate String type = \"Bearer\";\nprivate String username;\nprivate String email;\nprivate List&lt;String&gt; roles;\n</code></pre>"},{"location":"sequences/s3/auth/creation_form/","title":"Cr\u00e9ation des forms d\u2019authentification","text":"<p>Ici, nous allons cr\u00e9er les formulaires (forms) n\u00e9cessaires pour les requ\u00eates d\u2019authentification.</p> <p>Attention, il faut ajouter les annotations de validation appropri\u00e9es (@NotBlank, @Size, @Email, @Pattern ...).</p> <p>Aussi, chaque form doit inclure les constructeurs (un vide et un complet), getters et setters appropri\u00e9s.</p> <p>Cr\u00e9er un dossier <code>form</code>, cr\u00e9er la classe <code>RegisterForm</code> avec les attributs suivants.</p> <pre><code>private String username;\nprivate String email;\nprivate String password;\n</code></pre> <p>Puis, cr\u00e9er la classe <code>LoginForm</code> avec les attributs suivants :</p> <pre><code>private String username;\nprivate String password;\n</code></pre> <p>Enfin, cr\u00e9er la classe <code>RefreshTokenForm</code> avec l'attribut suivant :</p> <pre><code>private String refreshToken;\n</code></pre>"},{"location":"sequences/s3/auth/creation_form/#correction","title":"Correction","text":""},{"location":"sequences/s3/auth/creation_service/","title":"Cr\u00e9ation du service d\u2019authentification","text":"<p>Dans le dossier <code>service</code>, cr\u00e9er une nouvelle classe <code>AuthService</code> avec les annotations <code>@Service</code> et <code>@Transactional</code> :</p>"},{"location":"sequences/s3/auth/creation_service/#attributs","title":"Attributs","text":"<pre><code>\n@Autowired\nprivate AuthenticationManager authenticationManager;\n\n@Autowired\nprivate UserRepository userRepository;\n\n@Autowired\nprivate RoleRepository roleRepository;\n\n@Autowired\nprivate PasswordEncoder passwordEncoder;\n\n@Autowired\nprivate JwtService jwtService;\n</code></pre>"},{"location":"sequences/s3/auth/creation_service/#methodes","title":"M\u00e9thodes","text":"<pre><code>public MessageDTO registerUser(@Valid RegisterRequest registerRequest) {\n    if (userRepository.existsByUsername(registerRequest.getUsername())) {\n        throw new RuntimeException(\"Le nom d'utilisateur existe d\u00e9j\u00e0!\");\n    }\n\n    if (userRepository.existsByEmail(registerRequest.getEmail())) {\n        throw new RuntimeException(\"L'email existe d\u00e9j\u00e0!\");\n    }\n\n    User user = new User();\n    user.setUsername(registerRequest.getUsername());\n    user.setEmail(registerRequest.getEmail());\n    user.setCreatedAt(java.time.LocalDateTime.now());\n    user.setUpdatedAt(java.time.LocalDateTime.now());\n    user.setPassword(passwordEncoder.encode(registerRequest.getPassword()));\n\n    Set&lt;Role&gt; roles = new HashSet&lt;&gt;();\n    Role userRole = roleRepository.findByName(\"USER\")\n            .orElseThrow(() -&gt; new RuntimeException(\"Erreur: R\u00f4le non trouv\u00e9.\"));\n    roles.add(userRole);\n    user.setRoles(roles.stream().toList());\n\n    userRepository.save(user);\n    return new MessageDTO(\"Utilisateur enregistr\u00e9 avec succ\u00e8s!\");\n}\n\npublic AuthResponseDTO authenticateUser(LoginRequest loginRequest) {\n    Authentication authentication = authenticationManager.authenticate(\n            new UsernamePasswordAuthenticationToken(\n                    loginRequest.getUsername(),\n                    loginRequest.getPassword()\n            )\n    );\n\n    SecurityContextHolder.getContext().setAuthentication(authentication);\n\n    User user = userRepository.findByUsername(loginRequest.getUsername()).orElseThrow(() -&gt; new RuntimeException(\"Utilisateur non trouv\u00e9\"));\n\n    UserDetails userDetails = (UserDetails) authentication.getPrincipal();\n    String jwt = jwtService.generateToken(userDetails);\n    String refreshToken = jwtService.generateRefreshToken(userDetails);\n\n    List&lt;String&gt; roles = user.getRoles().stream()\n            .map(Role::getName)\n            .collect(Collectors.toList());\n\n    userRepository.save(user);\n\n    return new AuthResponseDTO(\n            jwt,\n            refreshToken,\n            user.getUsername(),\n            user.getEmail(),\n            roles\n    );\n}\n\npublic AuthResponseDTO refreshToken(String refreshToken) {\n    if (!jwtService.validateRefreshToken(refreshToken)) {\n        throw new RuntimeException(\"Refresh token invalide ou expir\u00e9\");\n    }\n\n    String username = jwtService.extractUsername(refreshToken);\n    User user = userRepository.findByUsername(username)\n            .orElseThrow(() -&gt; new RuntimeException(\"Utilisateur non trouv\u00e9\"));\n\n    UserDetails userDetails = org.springframework.security.core.userdetails.User\n            .withUsername(user.getUsername())\n            .password(user.getPassword())\n            .authorities(user.getRoles().stream()\n                    .map(role -&gt; \"ROLE_\" + role.getName())\n                    .toArray(String[]::new))\n            .build();\n\n    String newJwt = jwtService.generateToken(userDetails);\n    String newRefreshToken = jwtService.generateRefreshToken(userDetails);\n\n    List&lt;String&gt; roles = user.getRoles().stream()\n            .map(Role::getName)\n            .collect(Collectors.toList());\n\n    return new AuthResponseDTO(\n            newJwt,\n            newRefreshToken,\n            user.getUsername(),\n            user.getEmail(),\n            roles\n    );\n}\n\npublic void logout() {\n    SecurityContextHolder.clearContext();\n}\n\npublic boolean validateToken(String token) {\n    try {\n        String username = jwtService.extractUsername(token);\n        UserDetails userDetails = userRepository.findByUsername(username)\n                .map(user -&gt; org.springframework.security.core.userdetails.User\n                        .withUsername(user.getUsername())\n                        .password(user.getPassword())\n                        .authorities(user.getRoles().stream()\n                                .map(role -&gt; \"ROLE_\" + role.getName())\n                                .toArray(String[]::new))\n                        .build())\n                .orElse(null);\n\n        return userDetails != null &amp;&amp; jwtService.validateToken(token, userDetails);\n    } catch (Exception e) {\n        return false;\n    }\n}\n</code></pre>"},{"location":"sequences/s3/auth/creation_service/#explications","title":"Explications","text":""},{"location":"sequences/s3/auth/creation_service/#methode-registeruser","title":"M\u00e9thode <code>registerUser</code>","text":"<p>Cette m\u00e9thode permet d\u2019enregistrer un nouvel utilisateur. Elle v\u00e9rifie d\u2019abord si le nom d\u2019utilisateur ou l\u2019email existe d\u00e9j\u00e0 dans la base de donn\u00e9es. Si ce n\u2019est pas le cas, elle cr\u00e9e un nouvel utilisateur, encode son mot de passe, assigne le r\u00f4le \"USER\", et sauvegarde l\u2019utilisateur dans la base de donn\u00e9es.</p>"},{"location":"sequences/s3/auth/creation_service/#methode-authenticateuser","title":"M\u00e9thode <code>authenticateUser</code>","text":"<p>Cette m\u00e9thode g\u00e8re la connexion des utilisateurs. Elle utilise l\u2019<code>AuthenticationManager</code> pour authentifier l\u2019utilisateur avec le nom d\u2019utilisateur et le mot de passe fournis. Si l\u2019authentification r\u00e9ussit, elle g\u00e9n\u00e8re un token JWT et un token de rafra\u00eechissement, puis retourne ces tokens avec les informations de l\u2019utilisateur.</p>"},{"location":"sequences/s3/auth/creation_service/#methode-refreshtoken","title":"M\u00e9thode <code>refreshToken</code>","text":"<p>Cette m\u00e9thode permet de rafra\u00eechir le token JWT en utilisant un token de rafra\u00eechissement valide. Elle v\u00e9rifie d\u2019abord la validit\u00e9 du token de rafra\u00eechissement, puis g\u00e9n\u00e8re un nouveau token JWT et un nouveau token de rafra\u00eechissement.</p>"},{"location":"sequences/s3/auth/creation_service/#methode-logout","title":"M\u00e9thode <code>logout</code>","text":"<p>Cette m\u00e9thode g\u00e8re la d\u00e9connexion de l\u2019utilisateur en effa\u00e7ant le contexte de s\u00e9curit\u00e9.</p>"},{"location":"sequences/s3/auth/creation_service/#methode-validatetoken","title":"M\u00e9thode <code>validateToken</code>","text":"<p>Cette m\u00e9thode valide un token JWT en extrayant le nom d\u2019utilisateur et en v\u00e9rifiant si le token est valide pour cet utilisateur.</p>"},{"location":"sequences/s3/auth/preface_controller/","title":"Cr\u00e9ation du controller d'authentification - Avant de commencer","text":"<p>Le controller d\u2019authentification est responsable de la gestion des requ\u00eates HTTP li\u00e9es \u00e0 l\u2019authentification des utilisateurs. Il agit comme une interface entre le client (par exemple, une application web ou mobile) et le service d\u2019authentification que nous avons pr\u00e9c\u00e9demment cr\u00e9\u00e9.</p> <p>Nous allons cr\u00e9er un controller REST qui exposera plusieurs endpoints pour les op\u00e9rations d\u2019authentification courantes, telles que l\u2019inscription, la connexion et le rafra\u00eechissement des tokens JWT.</p>"},{"location":"sequences/s3/auth/preface_dto/","title":"Cr\u00e9ation des DTO d'authentification - Avant de commencer","text":"<p>Dans un premier temps, nous allons cr\u00e9er les DTO (Data Transfer Objects) n\u00e9cessaires pour les r\u00e9ponses du service d'authentification.</p> <p>Nous allons cr\u00e9er deux DTO principaux :</p> <ul> <li><code>MessageDTO</code> : pour encapsuler les messages de r\u00e9ponse (succ\u00e8s, erreurs).</li> <li><code>AuthResponseDTO</code> : pour encapsuler les donn\u00e9es de la r\u00e9ponse d'authentification (tokens JWT, nom d'utilisateur, email, r\u00f4les).</li> </ul>"},{"location":"sequences/s3/auth/preface_form/","title":"Cr\u00e9ation des form d'authentification - Avant de commencer","text":"<p>Lorsque l'utilisateur voudra s'inscrire ou se connecter, il devra fournir certaines informations via des formulaires (forms).</p> <p>\u00c0 la diff\u00e9rences des DTO (Data Transfer Objects) qui sont utilis\u00e9s pour structurer les donn\u00e9es \u00e9chang\u00e9es entre le client et le serveur, les formulaires sont sp\u00e9cifiquement con\u00e7us pour valider et capturer les donn\u00e9es d'entr\u00e9e de l'utilisateur. Ainsi, les formulaires incluent souvent des annotations de validation pour s'assurer que les donn\u00e9es fournies par l'utilisateur respectent certaines contraintes (par exemple, format d'email, longueur du mot de passe, etc.).</p> <p>Par exemple : </p> <pre><code>@NotBlank(message = \"L'email est obligatoire\")\n@Email(message = \"L'email doit \u00eatre valide\")\nprivate String email;\n</code></pre> <p>Nous allons cr\u00e9er trois formulaires principaux :</p> <ul> <li><code>RegisterForm</code> : pour l'inscription des nouveaux utilisateurs.</li> <li><code>LoginForm</code> : pour la connexion des utilisateurs existants.</li> <li><code>RefreshTokenForm</code> : pour le rafra\u00eechissement des tokens JWT.</li> </ul>"},{"location":"sequences/s3/auth/preface_service/","title":"Cr\u00e9ation du service d\u2019authentification - Avant de commencer","text":"<p>Le service d\u2019authentification est la pi\u00e8ce ma\u00eetresse de notre application.  C\u2019est lui qui va g\u00e9rer la logique m\u00e9tier li\u00e9e \u00e0 l\u2019authentification des utilisateurs, comme la cr\u00e9ation de comptes, la connexion, la gestion des tokens JWT, etc.</p> <p>Pr\u00e9c\u00e9demment, nous avons vu comment configurer la s\u00e9curit\u00e9 avec Spring Security et cr\u00e9\u00e9 un service JWT.</p> <p>Avant de commencer \u00e0 coder le service d\u2019authentification.</p>"},{"location":"sequences/s3/entites_repositories_service_et_dto/creation_controller/","title":"Cr\u00e9ation des controllers","text":""},{"location":"sequences/s3/entites_repositories_service_et_dto/creation_controller/#video-explicative","title":"Vid\u00e9o explicative","text":""},{"location":"sequences/s3/entites_repositories_service_et_dto/creation_controller/#1-creer-les-controllers","title":"1. Cr\u00e9er les controllers","text":"<ol> <li>Pour chaque entit\u00e9 avec laquelle on peut interagir dans l'application, cr\u00e9er un controller qui lui correspond. Attention de bien mapper les diff\u00e9rentes routes selon les normes expliqu\u00e9es (voir cours pr\u00e9c\u00e9dent).</li> <li>Si vous avez des difficult\u00e9s pour cr\u00e9er ces controllers, consultez le d\u00e9p\u00f4t Github fourni.</li> <li>Une fois vos controllers cr\u00e9\u00e9s, vous devez avoir l'arborescence suivante :</li> </ol> <pre><code>src/main/java/esgi.fyc.sso.authserver/\n\u2502\n\u2514\u2500\u2500 controller\n\u2502   \u2514\u2500\u2500 AuditLogController\n\u2502   \u2514\u2500\u2500 ClientController\n\u2502   \u2514\u2500\u2500 CompanyController\n\u2502   \u2514\u2500\u2500 PlanController\n\u2502   \u2514\u2500\u2500 RealmController\n\u2502   \u2514\u2500\u2500 RoleController\n\u2502   \u2514\u2500\u2500 UserController\n\u2502   \u2514\u2500\u2500 UserRealmController\n\u2502   \u2514\u2500\u2500 UserRoleController\n\u2502   \u2514\u2500\u2500 UserSessionController\n\u2514\u2500\u2500 dto\n|   \u2514\u2500\u2500 ...\n\u2514\u2500\u2500 mapper\n|   \u2514\u2500\u2500 ...\n\u2514\u2500\u2500 model\n|   \u2514\u2500\u2500 ...\n...\n</code></pre>"},{"location":"sequences/s3/entites_repositories_service_et_dto/creation_dto/","title":"Cr\u00e9ation des DAO","text":""},{"location":"sequences/s3/entites_repositories_service_et_dto/creation_dto/#video-explicative","title":"Vid\u00e9o explicative","text":""},{"location":"sequences/s3/entites_repositories_service_et_dto/creation_dto/#1-creer-les-dto","title":"1. Cr\u00e9er les DTO","text":"<ol> <li>Pour chaque entit\u00e9 de l'application, cr\u00e9er un DTO qui lui correspond. Attention de bien d\u00e9finir le DTO selon les normes expliqu\u00e9es (voir cours pr\u00e9c\u00e9dent).</li> <li>Si vous avez des difficult\u00e9s pour cr\u00e9er ces DTO, consultez le d\u00e9p\u00f4t Github fourni.</li> <li>Une fois vos DTO cr\u00e9\u00e9s, vous devez avoir l'arborescence suivante :</li> </ol> <pre><code>src/main/java/esgi.fyc.sso.authserver/\n\u2502\n\u2514\u2500\u2500 dto\n\u2502   \u2514\u2500\u2500 AuditLogDTO\n\u2502   \u2514\u2500\u2500 CompanyDTO\n\u2502   \u2514\u2500\u2500 EmailVerificationTokenDTO\n\u2502   \u2514\u2500\u2500 PasswordResetTokenDTO\n\u2502   \u2514\u2500\u2500 PlanDTO\n\u2502   \u2514\u2500\u2500 RealmDTO\n\u2502   \u2514\u2500\u2500 RoleDTO\n\u2502   \u2514\u2500\u2500 UserDTO\n\u2502   \u2514\u2500\u2500 UserRealmDTO\n\u2502   \u2514\u2500\u2500 UserRealmIdDTO\n\u2502   \u2514\u2500\u2500 UserRoleDTO\n\u2502   \u2514\u2500\u2500 UserRoleIdDTO\n\u2502   \u2514\u2500\u2500 UserSessionDTO\n\u2514\u2500\u2500 model\n|   \u2514\u2500\u2500 ...\n\u2514\u2500\u2500 repository\n|   \u2514\u2500\u2500 ...\n\u2514\u2500\u2500 service\n|   \u2514\u2500\u2500 ...\n...\n</code></pre> <p>Ensuite, nous allons passer \u00e0 la cr\u00e9ation des mappers.</p>"},{"location":"sequences/s3/entites_repositories_service_et_dto/creation_entites/","title":"Cr\u00e9er les entit\u00e9s","text":"<p>Rappel du sch\u00e9ma de base de donn\u00e9es :</p> <p></p>"},{"location":"sequences/s3/entites_repositories_service_et_dto/creation_entites/#video-explicative","title":"Vid\u00e9o explicative","text":""},{"location":"sequences/s3/entites_repositories_service_et_dto/creation_entites/#1-creer-les-entites","title":"1. Cr\u00e9er les entit\u00e9s","text":"<ol> <li> <p>Pour chaque table de la base de donn\u00e9es, cr\u00e9ez l'entit\u00e9 qui lui est li\u00e9e, avec :</p> <ul> <li>ses champs</li> <li>son/ses constructeurs</li> <li>ses getters et ses setters</li> </ul> </li> <li> <p>Si vous avez des difficult\u00e9s pour cr\u00e9er ces entit\u00e9s, consultez le d\u00e9p\u00f4t Github fourni.</p> </li> <li> <p>Une fois vos entit\u00e9s cr\u00e9es, vous devez avoir l'arborescence suivante :</p> </li> </ol> <pre><code>src/main/java/esgi.fyc.sso.authserver/\n\u2502\n\u2514\u2500\u2500 controller\n|   \u2514\u2500\u2500 ...\n\u251c\u2500\u2500 model\n\u2502   \u2514\u2500\u2500 AuditLog\n\u2502   \u2514\u2500\u2500 Company\n\u2502   \u2514\u2500\u2500 EmailVerificationToken\n\u2502   \u2514\u2500\u2500 PasswordResetToken\n\u2502   \u2514\u2500\u2500 Plan\n\u2502   \u2514\u2500\u2500 Realm\n\u2502   \u2514\u2500\u2500 Role\n\u2502   \u2514\u2500\u2500 User\n\u2502   \u2514\u2500\u2500 UserRealm\n\u2502   \u2514\u2500\u2500 UserRealmId\n\u2502   \u2514\u2500\u2500 UserRole\n\u2502   \u2514\u2500\u2500 UserRoleId\n\u2502   \u2514\u2500\u2500 UserSession\n\u2514\u2500\u2500 repository\n|   \u2514\u2500\u2500 ...\n\u2514\u2500\u2500 service\n|   \u2514\u2500\u2500 ...\n...\n</code></pre>"},{"location":"sequences/s3/entites_repositories_service_et_dto/creation_mapper/","title":"Cr\u00e9ation des mappers","text":""},{"location":"sequences/s3/entites_repositories_service_et_dto/creation_mapper/#video-explicative","title":"Vid\u00e9o explicative","text":""},{"location":"sequences/s3/entites_repositories_service_et_dto/creation_mapper/#1-creer-les-mappers","title":"1. Cr\u00e9er les mappers","text":"<ol> <li>Pour chaque entit\u00e9 &amp; DTO de l'application, cr\u00e9er un mapper qui lui correspond. Attention de bien d\u00e9finir le mapper selon les normes expliqu\u00e9es (voir cours pr\u00e9c\u00e9dent).</li> <li>Si vous avez des difficult\u00e9s pour cr\u00e9er ces mappers, consultez le d\u00e9p\u00f4t Github fourni.</li> <li>Une fois vos mappers cr\u00e9\u00e9s, vous devez avoir l'arborescence suivante :</li> </ol> <pre><code>src/main/java/esgi.fyc.sso.authserver/\n\u2502\n\u2514\u2500\u2500 mappers\n\u2502   \u2514\u2500\u2500 AuditLogMapper\n\u2502   \u2514\u2500\u2500 ClientMapper\n\u2502   \u2514\u2500\u2500 CompanyMapper\n\u2502   \u2514\u2500\u2500 PlanMapper\n\u2502   \u2514\u2500\u2500 RealmMapper\n\u2502   \u2514\u2500\u2500 RoleMapper\n\u2502   \u2514\u2500\u2500 UserMapper\n\u2502   \u2514\u2500\u2500 UserRealmMapper\n\u2502   \u2514\u2500\u2500 UserRoleMapper\n\u2502   \u2514\u2500\u2500 UserSessionMapper\n\u2514\u2500\u2500 model\n|   \u2514\u2500\u2500 ...\n\u2514\u2500\u2500 repository\n|   \u2514\u2500\u2500 ...\n\u2514\u2500\u2500 service\n|   \u2514\u2500\u2500 ...\n...\n</code></pre>"},{"location":"sequences/s3/entites_repositories_service_et_dto/creation_repositories/","title":"Cr\u00e9er les repositories","text":""},{"location":"sequences/s3/entites_repositories_service_et_dto/creation_repositories/#video-explicative","title":"Vid\u00e9o explicative","text":""},{"location":"sequences/s3/entites_repositories_service_et_dto/creation_repositories/#1-creer-les-repositories","title":"1. Cr\u00e9er les repositories","text":"<ol> <li>Cr\u00e9er les repositories pour chaque entit\u00e9 de l'application. Pensez \u00e0 cr\u00e9er des m\u00e9thodes pour r\u00e9aliser des r\u00e9cup\u00e9rations d'entit\u00e9 par rapport \u00e0 un id, et des m\u00e9thodes pour v\u00e9rifier si une entit\u00e9 existe d\u00e9j\u00e0 avec une certaine valeur pass\u00e9e en param\u00e8tre (voir exemple dans le cours pr\u00e9c\u00e9dent).</li> <li>Si vous avez des difficult\u00e9s pour cr\u00e9er ces repositories, consultez le d\u00e9p\u00f4t Github fourni.</li> <li>Une fois vos repositories cr\u00e9\u00e9s, vous devez avoir l'arborescence suivante :</li> </ol> <pre><code>src/main/java/esgi.fyc.sso.authserver/\n\u2502\n\u2514\u2500\u2500 controller\n|   \u2514\u2500\u2500 ...\n\u2502\u2514\u2500\u2500 model\n|   \u2514\u2500\u2500 ...\n\u2514\u2500\u2500 repository\n\u2502   \u2514\u2500\u2500 AuditLogRepository\n\u2502   \u2514\u2500\u2500 CompanyRepository\n\u2502   \u2514\u2500\u2500 EmailVerificationTokenRepository\n\u2502   \u2514\u2500\u2500 PasswordResetTokenRepository\n\u2502   \u2514\u2500\u2500 PlanRepository\n\u2502   \u2514\u2500\u2500 RealmRepository\n\u2502   \u2514\u2500\u2500 RoleRepository\n\u2502   \u2514\u2500\u2500 UserRepository\n\u2502   \u2514\u2500\u2500 UserRealmRepository\n\u2502   \u2514\u2500\u2500 UserRealmIdRepository\n\u2502   \u2514\u2500\u2500 UserRoleRepository\n\u2502   \u2514\u2500\u2500 UserRoleIdRepository\n\u2502   \u2514\u2500\u2500 UserSessionRepository\n\u2514\u2500\u2500 service\n|   \u2514\u2500\u2500 ...\n...\n</code></pre>"},{"location":"sequences/s3/entites_repositories_service_et_dto/creation_service/","title":"Cr\u00e9er les services","text":""},{"location":"sequences/s3/entites_repositories_service_et_dto/creation_service/#video-explicative","title":"Vid\u00e9o explicative","text":""},{"location":"sequences/s3/entites_repositories_service_et_dto/creation_service/#1-creer-les-services","title":"1. Cr\u00e9er les services","text":"<ol> <li>Cr\u00e9er les services pour chaque repository de l'application. Pensez \u00e0 cr\u00e9er les diff\u00e9rentes m\u00e9thodes que nous pourrons utiliser pour manipuler les donn\u00e9es de chaque table de la base de donn\u00e9es.</li> <li>Si vous avez des difficult\u00e9s pour cr\u00e9er ces services, consultez le d\u00e9p\u00f4t Github fourni.</li> <li>Une fois vos services cr\u00e9\u00e9s, vous devez avoir l'arborescence suivante :</li> </ol> <pre><code>src/main/java/esgi.fyc.sso.authserver/\n\u2502\n\u2514\u2500\u2500 controller\n|   \u2514\u2500\u2500 ...\n\u2514\u2500\u2500 model\n|   \u2514\u2500\u2500 ...\n\u2514\u2500\u2500 repository\n|   \u2514\u2500\u2500 ...\n\u2514\u2500\u2500 service\n\u2502   \u2514\u2500\u2500 AuditLogService\n\u2502   \u2514\u2500\u2500 CompanyService\n\u2502   \u2514\u2500\u2500 EmailVerificationTokenService\n\u2502   \u2514\u2500\u2500 PasswordResetTokenService\n\u2502   \u2514\u2500\u2500 PlanService\n\u2502   \u2514\u2500\u2500 RealmService\n\u2502   \u2514\u2500\u2500 RoleService\n\u2502   \u2514\u2500\u2500 UserService\n\u2502   \u2514\u2500\u2500 UserRealmService\n\u2502   \u2514\u2500\u2500 UserRealmIdService\n\u2502   \u2514\u2500\u2500 UserRoleService\n\u2502   \u2514\u2500\u2500 UserRoleIdService\n\u2502   \u2514\u2500\u2500 UserSessionService\n...\n</code></pre> <p>Nous pouvons ensuite passer \u00e0 la cr\u00e9ation des DTO.</p>"},{"location":"sequences/s3/entites_repositories_service_et_dto/preface_controller/","title":"Cr\u00e9ation des controllers - Avant de commencer","text":"<p>Dans cette partie, nous allons cr\u00e9er des controllers. Ces controllers vont nous servir \u00e0 d\u00e9finir des routes pour effectuer diverses actions depuis notre API. Chaque route doit \u00eatre unique, et effectuer une action qui lui est propre.</p>"},{"location":"sequences/s3/entites_repositories_service_et_dto/preface_controller/#classe","title":"Classe","text":"<ul> <li>un controller est une classe qui utilise un service. Il doit donc avoir un attribut correspondant au service de l'entit\u00e9.</li> <li>un controller, quand d\u00e9clar\u00e9, doit \u00eatre pr\u00e9c\u00e9d\u00e9 de l'annotation \"RestController\", pour signaler qu'on va fournir des requ\u00eates de type REST.</li> <li>un controller doit avoir un/plusieurs constructeurs, qui lui permettront de construire un objet utilisable.</li> <li>un controller doit avoir une route d\u00e9finie avec l'annotation 'RequestMapping(\"/api/[route]\")'</li> </ul> <p>exemple :</p> <pre><code>@RestController\n@RequestMapping(\"/api/roles\")\npublic class RoleController {\n\n    private final RoleService roleService;\n\n    public RoleController(RoleService roleService) {\n        this.roleService = roleService;\n    }\n}\n</code></pre>"},{"location":"sequences/s3/entites_repositories_service_et_dto/preface_controller/#methodes","title":"M\u00e9thodes","text":"<ul> <li>Chaque controller doit fournir des routes permettant d'effectuer des actions li\u00e9es \u00e0 l'entit\u00e9 \u00e0 laquelle il correspond.</li> <li>Chaque action d\u00e9finie doit \u00eatre disponible via une route unique et effectuer une action pr\u00e9cise.</li> <li>C'est \u00e9galement dans ces routes qu'il faut effectuer la gestion des erreurs.</li> </ul>"},{"location":"sequences/s3/entites_repositories_service_et_dto/preface_controller/#mapping-des-routes","title":"Mapping des routes","text":"<ul> <li>Lorsqu'on d\u00e9finit une route, il faut d\u00e9finir de quel type de route il s'agit :</li> <li>POST =&gt; Requ\u00eate o\u00f9 on cr\u00e9e des donn\u00e9es dans l'API =&gt; on utilise le tag \"@PostMapping\".</li> <li>GET =&gt; Requ\u00eate o\u00f9 on r\u00e9cup\u00e8re des donn\u00e9es dans l'API =&gt; on utilise le tag \"@GetMapping\".</li> <li>PUT =&gt; Requ\u00eate o\u00f9 on ins\u00e8re des donn\u00e9es \u00e0 un ensemble existant, dans l'API =&gt; on utilise le tag \"@PutMapping\".</li> <li>DELETE =&gt; Requ\u00eate o\u00f9 l'on supprime des donn\u00e9es dans l'API =&gt; on utilise le tag \"@DeleteMapping\".</li> </ul> <p>exemples de route :</p> <pre><code>/**\n* Cr\u00e9er un r\u00f4le\n* POST /api/roles\n*/\n@PostMapping\npublic ResponseEntity&lt;RoleDTO&gt; createRole(@RequestBody RoleDTO roleDTO) {\n    RoleDTO created = roleService.createRole(roleDTO);\n    if (created == null) {\n        return ResponseEntity.status(HttpStatus.BAD_REQUEST).build();\n    }\n    return new ResponseEntity&lt;&gt;(created, HttpStatus.CREATED);\n}\n\n/**\n* Lister tous les r\u00f4les\n* GET /api/roles\n*/\n@GetMapping\npublic ResponseEntity&lt;List&lt;RoleDTO&gt;&gt; getAllRoles() {\n    List&lt;RoleDTO&gt; roles = roleService.getAllRoles();\n    return ResponseEntity.ok(roles);\n}\n\n/**\n* Mettre \u00e0 jour un r\u00f4le\n* PUT /api/roles/{id}\n*/\n@PutMapping(\"/{id}\")\npublic ResponseEntity&lt;RoleDTO&gt; updateRole(@PathVariable Integer id, @RequestBody RoleDTO roleDTO) {\n    RoleDTO updated = roleService.updateRole(id, roleDTO);\n    if (updated == null) {\n        return ResponseEntity.notFound().build();\n    }\n    return ResponseEntity.ok(updated);\n}\n\n/**\n* Supprimer un r\u00f4le\n* DELETE /api/roles/{id}\n*/\n@DeleteMapping(\"/{id}\")\npublic ResponseEntity&lt;Void&gt; deleteRole(@PathVariable Integer id) {\n    boolean deleted = roleService.deleteRole(id);\n    if (!deleted) {\n        return ResponseEntity.notFound().build();\n    }\n    return ResponseEntity.noContent().build();\n}\n</code></pre>"},{"location":"sequences/s3/entites_repositories_service_et_dto/preface_dto/","title":"Cr\u00e9ation des DTO - Avant de commencer","text":"<p>Dans cette partie, nous allons cr\u00e9er des classes DTO (Data Transfert Object). Ces objets DTO ont pour utilit\u00e9 de communiquer directement avec la base de donn\u00e9es pour effectuer diverses actions. Ces objets sont des \"clones\" de nos entit\u00e9s, \u00e0 la diff\u00e9rence pr\u00e8s qu'elles repr\u00e9sentent la communication directe entre notre entit\u00e9 et sa table dans la base de donn\u00e9es. Avant de cr\u00e9er ces DTO, quelques explications :</p>"},{"location":"sequences/s3/entites_repositories_service_et_dto/preface_dto/#classe","title":"Classe","text":"<ul> <li>un DTO est une classe qui utilise un repository. Elle doit donc avoir un attribut correspondant au repository de l'entit\u00e9.</li> <li>un DTO, quand d\u00e9clar\u00e9, doit \u00eatre pr\u00e9c\u00e9d\u00e9 de l'annotation \"Repository\", pour signaler qu'on va interagir avec un regroupement de donn\u00e9es.</li> <li>un DTO doit avoir un/plusieurs constructeurs, qui lui permettront de construire un objet utilisable :</li> </ul> <p>exemple :</p> <pre><code>@Repository\npublic class TestDTO(){\n    private TestRepository testRepository;\n\n    public TestDTO(TestRepository testRepository){\n        this.testRepository = testRepository;\n    }\n}\n</code></pre>"},{"location":"sequences/s3/entites_repositories_service_et_dto/preface_dto/#methodes","title":"M\u00e9thodes","text":"<ul> <li>Chaque classe DTO doit permettre d'interagir avec les champs de la table \u00e0 laquelle il correspond et par cons\u00e9quent doit fournir des m\u00e9thodes permettant de modifier/consulter ces donn\u00e9es.</li> <li>On peut se servir de getters et de setters pour le faire :</li> </ul> <p>exemple :</p> <pre><code>public Integer getId() {\n    return id;\n}\n\npublic void setId(Integer id) {\n    this.id = id;\n}\n</code></pre> <p>Nous pouvons ensuite passer \u00e0 la cr\u00e9ation des DTO.</p>"},{"location":"sequences/s3/entites_repositories_service_et_dto/preface_entites/","title":"Cr\u00e9er les entit\u00e9s - Avant de commencer","text":"<p>Pour chaque table de la base de donn\u00e9es, il faut cr\u00e9er une entit\u00e9 qui lui correspond. Cette entit\u00e9 nous permettra d'interagir avec la table et ses donn\u00e9es, afin de pouvoir les manipuler. Avant de cr\u00e9er ces entit\u00e9s, voici quelques explications sur les normes &amp; syntaxes :</p>"},{"location":"sequences/s3/entites_repositories_service_et_dto/preface_entites/#champs","title":"Champs","text":"<ul> <li>chaque champ doit \u00eatre annot\u00e9 de <code>@Column</code> et de son nom dans la base de donn\u00e9es avec <code>(name = \"test\")</code></li> <li>si un champ doit \u00eatre unique, c'est \u00e0 dire qu'on ne peut pas avoir cette m\u00eame valeur sur plusieurs entit\u00e9s de la m\u00eame table, il faut l'indiquer avec <code>(unique = true)</code></li> <li>si un champ ne peut pas \u00eatre null en base de de donn\u00e9es, il doit \u00eatre annot\u00e9 avec <code>(nullable = false)</code></li> <li>si un champ est un id, il doit \u00eatre indiqu\u00e9 avec <code>@Id</code></li> <li>si un id est g\u00e9n\u00e9r\u00e9 par la table en sql de mani\u00e8re automatique, il faut l'indiquer avec <code>@GeneratedValue(strategy = GenerationType.IDENTITY)</code></li> </ul> <p>exemple : </p> <pre><code>@Id\n@GeneratedValue(strategy = GenerationType.IDENTITY)\nprivate Integer test;\n\n@Column(name = \"test2\", nullable = false, unique = true)\nprivate String test2;\n</code></pre>"},{"location":"sequences/s3/entites_repositories_service_et_dto/preface_entites/#constructeur","title":"Constructeur","text":"<ul> <li>pour chaque entit\u00e9, il faut un constructeur, c'est \u00e0 dire de quoi fournir des donn\u00e9es et construire une instance de cet objet, pour pouvoir l'utiliser.</li> </ul> <p>exemple :</p> <pre><code>public User(Integer test, String test2) {\n    this.test = test;\n    this.test2 = test2;\n}\n</code></pre>"},{"location":"sequences/s3/entites_repositories_service_et_dto/preface_entites/#getters-et-setters","title":"Getters et setters","text":"<ul> <li>pour chaque entit\u00e9, il faut fournir de quoi r\u00e9cup\u00e9rer ou modifier les donn\u00e9es d'un champ de cet objet. Pour cela, on passe par un getter ou un setter, pour chaque champ de l'entit\u00e9.</li> </ul> <p>exemple :</p> <pre><code>public Integer getTest() {\n    return test;\n}\n\npublic void setTest(Integer test) {\n    this.test = test;\n}\n</code></pre> <p>Dans l'\u00e9tape suivante, nous allons donc pouvoir cr\u00e9er les diff\u00e9rents entit\u00e9s de notre application.</p>"},{"location":"sequences/s3/entites_repositories_service_et_dto/preface_mapper/","title":"Cr\u00e9ation des mappers - Avant de commencer","text":"<p>Un mapper repr\u00e9sente la liaison entre notre entit\u00e9 et notre DTO. Cette classe est l\u00e0 pour faire le lien entre les deux types d'objets, et en transmettre les donn\u00e9es. Il faudra cr\u00e9er un mapper pour faire le lien entre chaque entit\u00e9 et chaque DTO de notre application. Avant de cr\u00e9er nos mappers, de petites explications s'imposent :</p> <ul> <li>pour que la liaison entre entit\u00e9 et DTO fonctionne, il faut obligatoirement avoir un mapper pour faire le lien entre les deux.</li> <li>un mapper doit \u00eatre capable de transmettre les donn\u00e9es d'une entit\u00e9 vers un DTO, et de transmettre des donn\u00e9es d'un DTO vers une entit\u00e9.</li> </ul> <p>exemple :</p> <pre><code>@Component\npublic class RoleMapper {\n\n    public RoleDTO toDto(Role role) {\n        if (role == null) {\n            return null;\n        }\n        RoleDTO dto = new RoleDTO();\n        dto.setId(role.getId());\n        dto.setName(role.getName());\n        dto.setDescription(role.getDescription());\n        dto.setCreatedAt(role.getCreatedAt());\n        dto.setUpdatedAt(role.getUpdatedAt());\n        return dto;\n    }\n\n    public Role toEntity(RoleDTO dto) {\n        if (dto == null) {\n            return null;\n        }\n        Role role = new Role();\n        role.setId(dto.getId());\n        role.setName(dto.getName());\n        role.setDescription(dto.getDescription());\n        role.setCreatedAt(dto.getCreatedAt());\n        role.setUpdatedAt(dto.getUpdatedAt());\n        return role;\n    }\n}\n\n</code></pre> <p>Dans cet exemple, toDTO va convertir une entit\u00e9 Role pass\u00e9e en param\u00e8tre en objet DTO, tandis que toEntity va convertir un DTO pass\u00e9 en param\u00e8tre en entit\u00e9. Le mapper a donc bien un r\u00f4le de convertisseur entre entit\u00e9 et DTO.</p> <p>Dans la prochaine section du cours, nous allons cr\u00e9er les mappers de sorte \u00e0 ce qu'ils puissent faire la conversion entre DTO et entit\u00e9.</p>"},{"location":"sequences/s3/entites_repositories_service_et_dto/preface_repositories/","title":"Cr\u00e9er les repositories - Avant de commencer","text":"<p>Maintenant que l'on a cr\u00e9\u00e9 toutes les entit\u00e9s de notre application, nous allons devoir cr\u00e9er des repositories. Avant de commencer \u00e0 cr\u00e9er nos repositories, de petites explications s'imposent :</p>"},{"location":"sequences/s3/entites_repositories_service_et_dto/preface_repositories/#classe","title":"Classe :","text":"<ul> <li>un repository est une classe Java qui va repr\u00e9senter un regroupement d'entit\u00e9s, qui repr\u00e9sente toutes les donn\u00e9es stock\u00e9es dans une table de la base de donn\u00e9es. </li> <li>pour d\u00e9clarer un repository, on \u00e9tend la classe JpaRepository.</li> <li>il faut \u00e9galement utiliser l'annotation <code>@Repository</code> sur la classe.</li> </ul> <p>exemple :</p> <pre><code>@Repository\npublic interface TestRepository extends JpaRepository&lt;Test, Integer&gt; {\n}\n</code></pre>"},{"location":"sequences/s3/entites_repositories_service_et_dto/preface_repositories/#methodes","title":"M\u00e9thodes :","text":"<ul> <li>on peut donner \u00e0 un repository des m\u00e9thodes pour effectuer certaines actions simples, visant \u00e0 r\u00e9cup\u00e9rer une entit\u00e9 en particulier, o\u00f9 \u00e0 v\u00e9rifier l'existence d'une entit\u00e9 en fonction d'une valeur et d'un champ.</li> <li>lorsque l'on d\u00e9finit une m\u00e9thode, si une m\u00e9thode peut ne rien renvoyer (par exemple lors de la recherche d'un \u00e9l\u00e9ment, qui peut ne pas exister), il faut la typer avec Optional, pour signaler qu'on peut ne rien recevoir en retour.</li> <li>le code correspondant \u00e0 ces m\u00e9thodes sera d\u00e9fini plus tard, dans le service correspondant \u00e0 cette entit\u00e9.</li> </ul> <p>exemple :</p> <pre><code>    Optional&lt;Test&gt; findByTest(Id test);\n\n    Optional&lt;Test&gt; findByTest2(String test2);\n\n    boolean existsByTest(Id test);\n\n    boolean existsByTest2(String test2);\n</code></pre> <p>Dans l'\u00e9tape suivante, nous allons donc pouvoir cr\u00e9er les diff\u00e9rents repositories li\u00e9s \u00e0 nos entit\u00e9s.</p>"},{"location":"sequences/s3/entites_repositories_service_et_dto/preface_services/","title":"Cr\u00e9er les services - Avant de commencer","text":"<p>La prochaine \u00e9tape, maintenant, est de cr\u00e9er les services, qui vont pouvoir effectuer diff\u00e9rentes actions sur notre repository, et ainsi pouvoir interagir avec la base de donn\u00e9es. Avant de commencer, quelques explications sur les services :</p>"},{"location":"sequences/s3/entites_repositories_service_et_dto/preface_services/#classe","title":"Classe","text":"<ul> <li>pour chaque entit\u00e9 (et donc repository) on doit avoir un service qui lui est li\u00e9.</li> <li>un service doit avoir comme attribut le repository auquel il est li\u00e9, afin de pouvoir effectuer des manipulations dessus.</li> <li>ce service permettra d'effectuer des actions REST sur notre repository, et donc de pouvoir interagir avec les donn\u00e9es.</li> <li>chaque service doit \u00eatre d\u00e9clar\u00e9 avec l'annotation <code>@Service</code>.</li> </ul> <p>exemple :</p> <pre><code>@Service\npublic class TestService {\n\n    private final TestRepository testRepository;\n\n}\n</code></pre>"},{"location":"sequences/s3/entites_repositories_service_et_dto/preface_services/#methodes","title":"M\u00e9thodes","text":"<ul> <li>chaque m\u00e9thode doit permettre d'effectuer une action vis \u00e0 vis du repository, dans la logique du syst\u00e8me REST.</li> <li>toute action qui devra \u00eatre possible de faire dans l'application vis \u00e0 vis de cette table doit obligatoirement \u00eatre d\u00e9finie dans le service.</li> <li>la gestion d'exception et le contr\u00f4le d'int\u00e9grit\u00e9 des donn\u00e9es doit se faire depuis le service, afin de garantir une bonne gestion des donne\u00e9s, et \u00e9viter d'effectuer des requ\u00eates sql avec de mauvais param\u00e8tres (entre autres).</li> </ul> <p>exemple :</p> <pre><code>    // Create a new test entity, with unique id\n    public Test createTest(Id test, String test2) {\n        if (testRepository.existsByTest(test)) {\n            throw new IllegalArgumentException(\"TestEntity with test '\" + test + \"' already exists\");\n        }\n        Test testEntity = new Test(test, test2);\n        Test savedTest = roleRepository.save(testEntity);\n        return testEntity;\n    }\n\n    // Get test by id\n    public Optional&lt;Test&gt; getTestById(Id test) {\n        return testRepository.findByTest(test)\n    }\n</code></pre> <p>Dans l'\u00e9tape suivante, nous allons donc pouvoir cr\u00e9er les diff\u00e9rents services li\u00e9s \u00e0 nos repositories.</p>"},{"location":"sequences/s3/evaluation_mi_parcours/","title":"Evaluation de Mi Parcours","text":"<p>Nous allons maintenant passer en revue ce que nous avons vu depuis le d\u00e9but de cette s\u00e9quence et \u00e9valuer vos connaissances.</p>"},{"location":"sequences/s3/evaluation_mi_parcours/#qcm-devaluation","title":"QCM d'\u00e9valuation","text":"<p>Un QCM d'\u00e9valuation est disponible. Il couvre les sujets suivants :</p> <ul> <li>Structuration d'un projet Spring Boot</li> <li>Introduction \u00e0 Hibernate &amp; Liquibase</li> <li>Cr\u00e9ation de la couche DTO &amp; Service</li> <li>Mise en place de Spring Security &amp; JWT</li> <li>Cr\u00e9ation du service et du controller d'authentification</li> </ul> <p>https://forms.gle/Kn6XXfSj2W5F9FPt6</p>"},{"location":"sequences/s3/hibernate_liquibase/hibernate/","title":"Introduction \u00e0 Hibernate","text":""},{"location":"sequences/s3/hibernate_liquibase/hibernate/#quest-ce-quhibernate","title":"Qu\u2019est-ce qu\u2019Hibernate ?","text":"<p>Hibernate est un ORM (Object-Relational Mapping), c\u2019est-\u00e0-dire un outil qui permet de faire le lien entre les objets Java et les tables d\u2019une base de donn\u00e9es relationnelle.</p> <p>En gros, il permet de manipuler des objets Java sans \u00e9crire directement de SQL. C\u2019est Hibernate qui se charge de traduire les op\u00e9rations Java (cr\u00e9ation, lecture, mise \u00e0 jour, suppression) en requ\u00eates SQL.</p>"},{"location":"sequences/s3/hibernate_liquibase/hibernate/#pourquoi-utiliser-hibernate-dans-ce-projet","title":"Pourquoi utiliser Hibernate dans ce projet ?","text":"<p>Hibernate est l'un des ORM les plus populaires et largement utilis\u00e9s dans l'\u00e9cosyst\u00e8me Java. Utiliser un ORM permet de gagner du temps et d'automatiser la gestion des interactions avec la base de donn\u00e9es.</p>"},{"location":"sequences/s3/hibernate_liquibase/hibernate/#exemple-dutilisation-dhibernate","title":"Exemple d\u2019utilisation d\u2019Hibernate","text":"<p>D\u00e9finissons une entit\u00e9 <code>User</code> qui sera mapp\u00e9e \u00e0 une table <code>users</code> dans la base de donn\u00e9es. Tout d'abord, nous cr\u00e9ons la classe <code>User</code> avec les annotations Hibernate n\u00e9cessaires :</p> <pre><code>@Entity\npublic class User {\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    private Long id;\n    private String username;\n}\n</code></pre> <p>Ici, on retrouve l'annotation <code>@Entity</code> qui indique qu\u2019il s\u2019agit d\u2019une entit\u00e9 persistante.</p> <p>L\u2019annotation <code>@Id</code> indique que le champ <code>id</code> est la cl\u00e9 primaire de l\u2019entit\u00e9, et <code>@GeneratedValue</code> sp\u00e9cifie que sa valeur sera g\u00e9n\u00e9r\u00e9e automatiquement par la base de donn\u00e9es.</p> <p>De fait, cette entity repr\u00e9sente en base une table SQL :</p> <pre><code>CREATE TABLE users (\n    id BIGINT PRIMARY KEY AUTO_INCREMENT,\n    username VARCHAR(255)\n);\n</code></pre>"},{"location":"sequences/s3/hibernate_liquibase/hibernate/#hibernate-et-jpa","title":"Hibernate et JPA","text":"<p>JPA (Java Persistence API) est une sp\u00e9cification Java EE. Hibernate est une impl\u00e9mentation de cette sp\u00e9cification.</p> <p>JPA d\u00e9finit comment g\u00e9rer la persistance.</p> <p>Hibernate fournit le code concret pour le faire.</p>"},{"location":"sequences/s3/hibernate_liquibase/hibernate/#annotations-principales","title":"Annotations principales","text":"<ul> <li><code>@Entity</code> : Indique qu\u2019une classe est une entit\u00e9 persistante.</li> <li><code>@Table(name = \"table_name\")</code> : Sp\u00e9cifie le nom de la table en base de donn\u00e9es.</li> <li><code>@Id</code> : Indique le champ qui est la cl\u00e9 primaire.</li> <li><code>@GeneratedValue(strategy = GenerationType.IDENTITY)</code> : Sp\u00e9cifie que la valeur de la cl\u00e9 primaire est g\u00e9n\u00e9r\u00e9e automatiquement.</li> <li><code>@Column(name = \"column_name\")</code> : Sp\u00e9cifie le nom de la colonne en base de donn\u00e9es.</li> <li><code>@OneToMany</code>, <code>@ManyToOne</code>, <code>@ManyToMany</code> : D\u00e9finissent les relations entre les entit\u00e9s.</li> </ul>"},{"location":"sequences/s3/hibernate_liquibase/hibernate/#operations-principales","title":"Op\u00e9rations principales","text":"<ul> <li><code>findAll()</code> : R\u00e9cup\u00e9rer toutes les entit\u00e9s d\u2019un type donn\u00e9.</li> <li><code>findById(id)</code> : R\u00e9cup\u00e9rer une entit\u00e9 par son ID.</li> <li><code>save(entity)</code> : Enregistrer une nouvelle entit\u00e9 ou mettre \u00e0 jour une entit\u00e9 existante.</li> <li><code>delete(entity)</code> : Supprimer une entit\u00e9.</li> <li><code>deleteById(id)</code> : Supprimer une entit\u00e9 par son ID.</li> <li><code>deleteAll()</code> : Supprimer toutes les entit\u00e9s d\u2019un type donn\u00e9.</li> <li><code>count()</code> : Compter le nombre d\u2019entit\u00e9s d\u2019un type donn\u00e9.</li> <li><code>existsById(id)</code> : V\u00e9rifier si une entit\u00e9 existe par son ID.</li> <li><code>query()</code> : Ex\u00e9cuter des requ\u00eates personnalis\u00e9es.</li> </ul>"},{"location":"sequences/s3/hibernate_liquibase/hibernate/#operateurs-disponibles","title":"Op\u00e9rateurs disponibles","text":"Op\u00e9rateur Exemple SQL g\u00e9n\u00e9r\u00e9 <code>And</code> <code>findByUsernameAndEmail(String username, String email)</code> <code>SELECT * FROM users WHERE username = ? AND email = ?</code> <code>Or</code> <code>findByUsernameOrEmail(String username, String email)</code> <code>SELECT * FROM users WHERE username = ? OR email = ?</code> <code>Between</code> <code>findByAgeBetween(int start, int end)</code> <code>SELECT * FROM users WHERE age BETWEEN ? AND ?</code> <code>LessThan</code> <code>findByAgeLessThan(int age)</code> <code>SELECT * FROM users WHERE age &lt; ?</code> <code>GreaterThan</code> <code>findByAgeGreaterThan(int age)</code> <code>SELECT * FROM users WHERE age &gt; ?</code> <code>Like</code> <code>findByUsernameLike(String pattern)</code> <code>SELECT * FROM users WHERE username LIKE ?</code> <code>In</code> <code>findByRoleIn(List&lt;String&gt; roles)</code> <code>SELECT * FROM users WHERE role IN (?)</code> <code>OrderBy</code> <code>findByOrderByUsernameAsc()</code> <code>SELECT * FROM users ORDER BY username ASC</code>"},{"location":"sequences/s3/hibernate_liquibase/hibernate/#conclusion","title":"Conclusion","text":"<p>Hibernate est un outil puissant pour g\u00e9rer la persistance des donn\u00e9es dans une application Java. Il simplifie grandement les interactions avec la base de donn\u00e9es en permettant de travailler avec des objets Java plut\u00f4t qu\u2019avec du SQL brut. Dans ce projet, nous utiliserons Hibernate pour g\u00e9rer les entit\u00e9s et les op\u00e9rations CRUD sur la base de donn\u00e9es.</p>"},{"location":"sequences/s3/hibernate_liquibase/hibernate/#sources","title":"Sources","text":"<ul> <li>Documentation officielle Hibernate</li> <li>Guide JPA de Baeldung</li> <li>Spring Data JPA</li> </ul>"},{"location":"sequences/s3/hibernate_liquibase/integration/","title":"Int\u00e9gration d'Hibernate et Liquibase","text":""},{"location":"sequences/s3/hibernate_liquibase/integration/#configuration-du-projet","title":"Configuration du projet","text":"<p>Fichier <code>application.properties</code></p> <p>Voici la configuration utilis\u00e9e :</p> <pre><code>spring.liquibase.change-log=${LIQUIBASE_CHANGE_LOG:classpath:db.changelog/fycsso-changelog.xml}\nspring.jpa.generate-ddl=true\nspring.jpa.hibernate.ddl-auto=update\nspring.jpa.show-sql=true\n</code></pre> <ul> <li><code>spring.liquibase.change-log</code> : Sp\u00e9cifie le chemin du fichier de changelog Liquibase. On utilise une variable   d\u2019environnement <code>LIQUIBASE_CHANGE_LOG</code> pour permettre la personnalisation.</li> <li><code>spring.jpa.generate-ddl</code> : Indique \u00e0 Spring JPA de g\u00e9n\u00e9rer le sch\u00e9ma de la base de donn\u00e9es.</li> <li><code>spring.jpa.hibernate.ddl-auto</code> : D\u00e9finit la strat\u00e9gie de mise \u00e0 jour du sch\u00e9ma. Ici, <code>update</code> permet \u00e0 Hibernate de   mettre \u00e0 jour le sch\u00e9ma en fonction des entit\u00e9s.</li> <li><code>spring.jpa.show-sql</code> : Affiche les requ\u00eates SQL g\u00e9n\u00e9r\u00e9es par Hibernate dans la console pour le d\u00e9bogage.</li> </ul>"},{"location":"sequences/s3/hibernate_liquibase/integration/#structure-des-changelogs-liquibase","title":"Structure des changelogs Liquibase","text":"<p>Liquibase repose sur un fichier ma\u00eetre, ici fycsso-changelog.xml, qui inclut toutes les versions de sch\u00e9ma du projet.</p> <p>Arborescence</p> <pre><code>src/main/resources/db.changelog/\n\u2502\n\u251c\u2500\u2500 fycsso-changelog.xml\n\u2514\u2500\u2500 1.0/\n    \u2514\u2500\u2500 001.xml\n    \u2514\u2500\u2500 002.xml\n\u2514\u2500\u2500 1.1/\n    \u2514\u2500\u2500 001.xml\n    ...\n</code></pre> <p>Contenu du fichier ma\u00eetre fycsso-changelog.xml</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;databaseChangeLog\n        xmlns=\"http://www.liquibase.org/xml/ns/dbchangelog\"\n        xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n        xsi:schemaLocation=\"http://www.liquibase.org/xml/ns/dbchangelog\nhttps://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-latest.xsd\"&gt;\n\n    &lt;!-- Version 1.0 --&gt;\n    &lt;include file=\"db.changelog/1.0/001.xml\"/&gt;\n\n&lt;/databaseChangeLog&gt;\n</code></pre> <p>Ainsi, chaque version du sch\u00e9ma (1.0, 1.1, etc.) a ses propres fichiers *.xml regroupant les changeSet.</p>"},{"location":"sequences/s3/hibernate_liquibase/integration/#exemple-de-fichier-de-migration-001xml","title":"Exemple de fichier de migration (001.xml)","text":"<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;databaseChangeLog\n        xmlns=\"http://www.liquibase.org/xml/ns/dbchangelog\"\n        xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n        xsi:schemaLocation=\"http://www.liquibase.org/xml/ns/dbchangelog\n    https://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-latest.xsd\"&gt;\n\n    &lt;changeSet id=\"create-initial-tables\" author=\"mathys\"&gt;\n        &lt;sqlFile path=\"db/scripts/schema.sql\"/&gt;\n    &lt;/changeSet&gt;\n\n&lt;/databaseChangeLog&gt;\n</code></pre> <p>Ici, on inclut un script SQL externe pour cr\u00e9er les tables initiales.</p> <p>Voici le sch\u00e9ma SQL correspondant :</p> <p></p>"},{"location":"sequences/s3/hibernate_liquibase/integration/#integration-avec-hibernate","title":"Int\u00e9gration avec Hibernate","text":"<p>Chaque table SQL correspond \u00e0 une entit\u00e9 Java dans le dossier :</p> <p><code>model/</code></p> <p>Exemple :</p> <pre><code>@Entity\n@Table(name = \"role\")\npublic class Role {\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    private Integer id;\n\n    private String name;\n    private String description;\n}\n\n</code></pre> <p>Chaque entit\u00e9 a son repository d\u00e9di\u00e9 dans :</p> <p><code>/repository</code></p> <p>Exemple :</p> <pre><code>@Repository\npublic interface RoleRepository extends JpaRepository&lt;Role, Integer&gt; {\nOptional&lt;Role&gt; findByName(String name);\n}\n</code></pre> <p>Ainsi, Hibernate g\u00e8re la persistance des entit\u00e9s d\u00e9finies en Java, tandis que Liquibase s'occupe de la gestion des versions du sch\u00e9ma de la base de donn\u00e9es.</p>"},{"location":"sequences/s3/hibernate_liquibase/integration/#evolutions-du-code","title":"\u00c9volutions du code","text":"<p>A la fin de ce chapitre, vous devriez avoir ces modifications dans votre projet :</p> <ul> <li><code>application.properties</code></li> <li><code>fycsso-changelog.xml</code></li> <li><code>001.xml</code></li> </ul>"},{"location":"sequences/s3/hibernate_liquibase/liquibase/","title":"Introduction \u00e0 Liquibase","text":""},{"location":"sequences/s3/hibernate_liquibase/liquibase/#quest-ce-que-liquibase","title":"Qu\u2019est-ce que Liquibase ?","text":"<p>Liquibase est un outil open-source de versioning de base de donn\u00e9es. Il permet de g\u00e9rer, suivre et d\u00e9ployer les changements de sch\u00e9ma, un peu comme Git le fait pour le code.</p>"},{"location":"sequences/s3/hibernate_liquibase/liquibase/#pourquoi-utiliser-liquibase-dans-ce-projet","title":"Pourquoi utiliser Liquibase dans ce projet ?","text":"<p>Dans un projet o\u00f9 la base de donn\u00e9es \u00e9volue fr\u00e9quemment, il est important de garder une trace des modifications apport\u00e9es au sch\u00e9ma. On va alors utiliser Liquibase et des changlogs pour documenter chaque changement. Chaque fois qu\u2019une modification est n\u00e9cessaire (ajout de table, modification de colonne, etc.), on cr\u00e9e un nouveau changelog. Cela permet de s\u2019assurer que toutes les instances de la base de donn\u00e9es sont synchronis\u00e9es avec le sch\u00e9ma attendu par l\u2019application.</p>"},{"location":"sequences/s3/hibernate_liquibase/liquibase/#exemple-dutilisation-de-liquibase","title":"Exemple d\u2019utilisation de Liquibase","text":""},{"location":"sequences/s3/hibernate_liquibase/liquibase/#structure-dun-changelog","title":"Structure d\u2019un changelog","text":"<p>Un changelog est un fichier XML, YAML, JSON ou SQL qui d\u00e9crit les changements \u00e0 apporter \u00e0 la base de donn\u00e9es. Voici un exemple simple en XML :</p> <pre><code>&lt;databaseChangeLog\n    xmlns=\"http://www.liquibase.org/xml/ns/dbchangelog\"\n    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n    xsi:schemaLocation=\"http://www.liquibase.org/xml/ns/dbchangelog\n        http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.8.xsd\"&gt;\n\n    &lt;changeSet id=\"1\" author=\"votre_nom\"&gt;\n        &lt;createTable tableName=\"users\"&gt;\n            &lt;column name=\"id\" type=\"BIGINT\" autoIncrement=\"true\"&gt;\n                &lt;constraints primaryKey=\"true\"/&gt;\n            &lt;/column&gt;\n            &lt;column name=\"username\" type=\"VARCHAR(255)\"/&gt;\n        &lt;/createTable&gt;\n    &lt;/changeSet&gt;\n&lt;/databaseChangeLog&gt;\n</code></pre>"},{"location":"sequences/s3/hibernate_liquibase/liquibase/#explication-du-changelog","title":"Explication du changelog","text":"<ul> <li><code>&lt;databaseChangeLog&gt;</code> : Racine du fichier de changelog.</li> <li><code>&lt;changeSet&gt;</code> : D\u00e9finit un ensemble de changements \u00e0 appliquer. Chaque <code>changeSet</code> doit avoir un <code>id</code> unique et un <code>author</code>.</li> <li><code>&lt;createTable&gt;</code> : Cr\u00e9e une nouvelle table dans la base de donn\u00e9es.</li> <li><code>&lt;column&gt;</code> : D\u00e9finit une colonne dans la table, avec son nom et son type.</li> <li><code>&lt;constraints&gt;</code> : Sp\u00e9cifie les contraintes sur la colonne, comme la cl\u00e9 primaire.</li> </ul>"},{"location":"sequences/s3/hibernate_liquibase/liquibase/#bonnes-pratiques","title":"Bonnes pratiques","text":"<ul> <li>Utiliser des <code>changeSet</code> petits et sp\u00e9cifiques pour faciliter la gestion des modifications.</li> <li>Documenter chaque <code>changeSet</code> avec des commentaires pour expliquer son but.</li> </ul>"},{"location":"sequences/s3/hibernate_liquibase/liquibase/#sources","title":"Sources","text":"<ul> <li>Documentation officielle de Liquibase</li> <li>Guide d'utilisation de Liquibase avec Spring Boot</li> </ul>"},{"location":"sequences/s3/mvc/rappels/","title":"Rappel et principes de l\u2019architecture MVC","text":"<p>Le MVC (Model-View-Controller) est un mod\u00e8le architectural qui vise \u00e0 s\u00e9parer les responsabilit\u00e9s d\u2019une application en trois couches distinctes et compl\u00e9mentaires :</p> <ul> <li>Model \u2192 repr\u00e9sente les donn\u00e9es, la logique m\u00e9tier et les r\u00e8gles de gestion.</li> <li>View \u2192 g\u00e8re l\u2019affichage et l\u2019interface utilisateur.</li> <li>Controller \u2192 re\u00e7oit les requ\u00eates utilisateur, invoque la logique m\u00e9tier et d\u00e9termine la vue \u00e0 renvoyer.</li> </ul>"},{"location":"sequences/s3/mvc/rappels/#role-de-chaque-couche","title":"R\u00f4le de chaque couche","text":""},{"location":"sequences/s3/mvc/rappels/#model","title":"Model","text":"<p>Le Model contient les entit\u00e9s (objets repr\u00e9sentant les donn\u00e9es, souvent mapp\u00e9es \u00e0 une table de base de donn\u00e9es),  ainsi que la logique m\u00e9tier (les r\u00e8gles fonctionnelles propres \u00e0 l\u2019application) et la persistance des donn\u00e9es.</p> <p>Exemple : L\u2019entit\u00e9 <code>User</code>, li\u00e9e \u00e0 la table <code>users</code> dans la base de donn\u00e9es. </p> <p>Le service <code>UserService</code>, qui contient les traitements li\u00e9s aux utilisateurs. </p> <p>Le repository <code>UserRepository</code>, qui g\u00e8re les op\u00e9rations CRUD (Create, Read, Update, Delete) sur les utilisateurs.</p>"},{"location":"sequences/s3/mvc/rappels/#view","title":"View","text":"<p>La View est charg\u00e9e de pr\u00e9senter les donn\u00e9es au client (sous forme HTML, JSON, XML, etc.). Dans une application Spring Boot REST, la vue n\u2019est pas une page HTML, mais plut\u00f4t les r\u00e9ponses JSON renvoy\u00e9es au client (par exemple une application front-end en React ou Angular).</p> <p>Exemple : Une requ\u00eate HTTP GET vers <code>/api/users/1</code> renvoie une r\u00e9ponse JSON contenant :</p> <pre><code>{\n  \"id\": 1,\n  \"username\": \"dupond\",\n  \"email\": \"Dupond@example.com\"\n}\n</code></pre>"},{"location":"sequences/s3/mvc/rappels/#controller","title":"Controller","text":"<p>Le Controller est l'interm\u00e9diaire entre le client et le serveur. Il re\u00e7oit les requ\u00eates HTTP, appelle les services du mod\u00e8le pour traiter les donn\u00e9es,  et retourne les r\u00e9ponses appropri\u00e9es (souvent sous forme JSON dans une API REST).</p> <p>Exemple : Le <code>UserController</code> qui g\u00e8re les requ\u00eates li\u00e9es aux utilisateurs, comme la r\u00e9cup\u00e9ration, la cr\u00e9ation, la mise \u00e0 jour et la suppression d\u2019utilisateurs.</p> <p><code>GET /api/users/{id}</code> \u2192 R\u00e9cup\u00e9rer un utilisateur par son ID.</p> <p><code>POST /api/users</code> \u2192 Cr\u00e9er un nouvel utilisateur.</p> <p><code>PUT /api/users/{id}</code> \u2192 Mettre \u00e0 jour un utilisateur existant.</p> <p><code>DELETE /api/users/{id}</code> \u2192 Supprimer un utilisateur.</p>"},{"location":"sequences/s3/mvc/rappels/#pourquoi-utiliser-mvc-plutot-quune-architecture-monolithique-ou-non-structuree","title":"Pourquoi utiliser MVC plut\u00f4t qu\u2019une architecture monolithique ou non structur\u00e9e ?","text":"<p>Le mod\u00e8le MVC apporte plusieurs avantages majeurs par rapport \u00e0 une architecture o\u00f9  tout serait centralis\u00e9 dans un m\u00eame bloc de code comme par exemple :</p> <ul> <li>La s\u00e9paration des responsabilit\u00e9s : chaque couche a un r\u00f4le bien d\u00e9fini, ce qui facilite la maintenance et l\u2019\u00e9volution du code.</li> <li>La testabilit\u00e9 : chaque couche peut \u00eatre test\u00e9e ind\u00e9pendamment, ce qui am\u00e9liore la qualit\u00e9 du code.</li> <li>La r\u00e9utilisabilit\u00e9 : les composants de chaque couche peuvent \u00eatre r\u00e9utilis\u00e9s dans d\u2019autres parties de l\u2019application ou dans d\u2019autres projets.</li> </ul>"},{"location":"sequences/s3/mvc/rappels/#sources","title":"Sources","text":"<ul> <li>Mod\u00e8le MVC - Wikipedia</li> </ul>"},{"location":"sequences/s3/security/creation_configuration/","title":"Configuration de Spring Security","text":"<p>Afin de s\u00e9curiser notre application, nous allons cr\u00e9er une classe de configuration d\u00e9di\u00e9e \u00e0 Spring Security.</p> <p>\u00c0 la m\u00eame hauteur que le dossier <code>controller</code>, cr\u00e9ez un nouveau dossier <code>config</code> et \u00e0 l'int\u00e9rieur, cr\u00e9ez une classe <code>SpringSecurityConfig.java</code> :</p> <p>Comme expliqu\u00e9 dans la pr\u00e9face, le fichier de configuration de Spring Security va d\u00e9finir les r\u00e8gles de s\u00e9curit\u00e9 pour notre application, y compris les endpoints accessibles sans authentification et ceux qui n\u00e9cessitent une authentification. Dans ce sens, nous allons commencer par \u00e9crire les fichiers permettant de filtrer les requ\u00eates HTTP entrantes et de valider les tokens JWT afin d'ensuite les int\u00e9grer dans la configuration de Spring Security.</p>"},{"location":"sequences/s3/security/creation_configuration/#jwtauthenticationfilterjava","title":"JwtAuthenticationFilter.java","text":"<p>Cette classe est un component Spring qui va \u00e9tendre <code>OncePerRequestFilter</code> pour s'assurer que le filtre est ex\u00e9cut\u00e9 une seule fois par requ\u00eate. Elle va intercepter les requ\u00eates entrantes, extraire le token JWT, le valider et configurer le contexte de s\u00e9curit\u00e9 si le token est valide.</p> <pre><code>@Component\npublic class JwtAuthenticationFilter extends OncePerRequestFilter {\n\n    @Autowired\n    private JwtService jwtService;\n\n    @Autowired\n    private UserService userService;\n\n    @Override\n    protected void doFilterInternal(HttpServletRequest request,\n                                    HttpServletResponse response,\n                                    FilterChain filterChain) throws ServletException, IOException {\n\n        final String authHeader = request.getHeader(\"Authorization\");\n        final String jwt;\n        final String username;\n\n        if (authHeader == null || !authHeader.startsWith(\"Bearer \")) {\n            filterChain.doFilter(request, response);\n            return;\n        }\n\n        jwt = authHeader.substring(7);\n        username = jwtService.extractUsername(jwt);\n\n        if (username != null &amp;&amp; SecurityContextHolder.getContext().getAuthentication() == null) {\n            UserDetails userDetails = this.userService.loadUserByUsername(username);\n\n            if (jwtService.validateToken(jwt, userDetails)) {\n                UsernamePasswordAuthenticationToken authToken = new UsernamePasswordAuthenticationToken(\n                        userDetails,\n                        null,\n                        userDetails.getAuthorities()\n                );\n                authToken.setDetails(new WebAuthenticationDetailsSource().buildDetails(request));\n                SecurityContextHolder.getContext().setAuthentication(authToken);\n            }\n        }\n        filterChain.doFilter(request, response);\n    }\n}\n</code></pre>"},{"location":"sequences/s3/security/creation_configuration/#explications","title":"Explications","text":""},{"location":"sequences/s3/security/creation_configuration/#attributs","title":"Attributs","text":"<ul> <li><code>JwtService</code> : Service cr\u00e9\u00e9 pr\u00e9c\u00e9demment pour g\u00e9rer les op\u00e9rations li\u00e9es aux tokens JWT, comme l'extraction du nom d'utilisateur et la validation du token.</li> <li><code>UserService</code> : Service \u00e9tendant <code>UserDetailsService</code> (classe Spring Security) pour charger les d\u00e9tails de l'utilisateur \u00e0 partir de la base de donn\u00e9es.</li> </ul>"},{"location":"sequences/s3/security/creation_configuration/#methode-dofilterinternal","title":"M\u00e9thode <code>doFilterInternal</code>","text":"<p>Cette m\u00e9thode est appel\u00e9e pour chaque requ\u00eate HTTP entrante.</p> <ul> <li>Elle commence par extraire l'en-t\u00eate <code>Authorization</code> de la requ\u00eate.</li> <li>Si l'en-t\u00eate est absent ou ne commence pas par \"Bearer \", le filtre passe la requ\u00eate au filtre suivant dans la cha\u00eene.</li> <li>Si un token JWT est pr\u00e9sent, il extrait le token en supprimant le pr\u00e9fixe \"Bearer \".</li> <li>Ensuite, il utilise le <code>JwtService</code> pour extraire le nom d'utilisateur du token.</li> <li>Si le nom d'utilisateur est valide et qu'aucune authentification n'est encore pr\u00e9sente dans le contexte de s\u00e9curit\u00e9, il charge les d\u00e9tails de l'utilisateur \u00e0 partir du <code>UserService</code>.</li> <li>Il valide ensuite le token JWT.</li> <li>Si le token est valide, il cr\u00e9e un objet <code>UsernamePasswordAuthenticationToken</code> avec les d\u00e9tails de l'utilisateur et le d\u00e9finit dans le contexte de s\u00e9curit\u00e9 de Spring.</li> <li>Enfin, il passe la requ\u00eate au filtre suivant dans la cha\u00eene.</li> </ul>"},{"location":"sequences/s3/security/creation_configuration/#corsconfig","title":"CorsConfig","text":"<p>Cette classe de configuration impl\u00e9mente <code>CorsConfigurationSource</code> (composant Spring) pour d\u00e9finir les r\u00e8gles CORS (Cross-Origin Resource Sharing) de l'application. Elle permet de sp\u00e9cifier quels domaines sont autoris\u00e9s \u00e0 acc\u00e9der aux ressources de l'API, ainsi que les m\u00e9thodes HTTP et les en-t\u00eates autoris\u00e9s.</p> <pre><code>@Configuration\npublic class CorsConfig implements CorsConfigurationSource {\n\n    @Bean\n    public CorsConfigurationSource corsConfigurationSource() {\n        CorsConfiguration configuration = new CorsConfiguration();\n\n        configuration.setAllowedOrigins(Arrays.asList(\n                \"http://localhost:3000\",\n                \"http://localhost:5173\"\n        ));\n\n        configuration.setAllowedMethods(Arrays.asList(\n                \"GET\", \"POST\", \"PUT\", \"DELETE\", \"OPTIONS\", \"PATCH\"\n        ));\n\n        configuration.setAllowedHeaders(Arrays.asList(\n                \"Authorization\",\n                \"Content-Type\",\n                \"X-Requested-With\",\n                \"Accept\",\n                \"Origin\",\n                \"Access-Control-Request-Method\",\n                \"Access-Control-Request-Headers\"\n        ));\n\n        configuration.setExposedHeaders(Arrays.asList(\n                \"Access-Control-Allow-Origin\",\n                \"Access-Control-Allow-Credentials\",\n                \"Authorization\"\n        ));\n\n        configuration.setAllowCredentials(true);\n\n        configuration.setMaxAge(3600L);\n\n        UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();\n        source.registerCorsConfiguration(\"/**\", configuration);\n\n        return source;\n    }\n\n    @Override\n    @SuppressWarnings(\"NullableProblems\")\n    public CorsConfiguration getCorsConfiguration(HttpServletRequest request) {\n        return corsConfigurationSource().getCorsConfiguration(request);\n    }\n}\n</code></pre>"},{"location":"sequences/s3/security/creation_configuration/#explications_1","title":"Explications","text":""},{"location":"sequences/s3/security/creation_configuration/#methode-corsconfigurationsource","title":"M\u00e9thode <code>corsConfigurationSource</code>","text":"<p>Cette m\u00e9thode cr\u00e9e et configure un objet <code>CorsConfiguration</code>.</p> <p>\u00c0 cet objet, nous allons ajouter plusieurs r\u00e8gles :</p> <ul> <li><code>setAllowedOrigins</code>: D\u00e9finit les origines autoris\u00e9es \u00e0 acc\u00e9der \u00e0 l'API. Ici, nous autorisons les applications front-end locales ex\u00e9cut\u00e9es sur les ports 3000 (React) et 5173 (Vite).</li> <li><code>setAllowedMethods</code>: Sp\u00e9cifie les m\u00e9thodes HTTP autoris\u00e9es pour les requ\u00eates cross-origin (GET, POST, PUT, DELETE, OPTIONS, PATCH).</li> <li><code>setAllowedHeaders</code>: D\u00e9finit les en-t\u00eates HTTP autoris\u00e9s dans les requ\u00eates cross-origin.</li> <li><code>setExposedHeaders</code>: Sp\u00e9cifie les en-t\u00eates qui peuvent \u00eatre expos\u00e9s aux clients.</li> <li><code>setAllowCredentials</code>: Indique si les cookies et les informations d'authentification sont autoris\u00e9s dans les requ\u00eates cross-origin.</li> <li><code>setMaxAge</code>: D\u00e9finit la dur\u00e9e pendant laquelle les r\u00e9sultats d'une requ\u00eate pr\u00e9-vol peuvent \u00eatre mis en cache.</li> </ul> <p>Enfin, nous enregistrons cette configuration pour toutes les URL (<code>/**</code>) dans un <code>UrlBasedCorsConfigurationSource</code>.</p>"},{"location":"sequences/s3/security/creation_configuration/#springsecurityconfigjava","title":"SpringSecurityConfig.java","text":"<p>Une fois le filtre JWT et la configuration CORS cr\u00e9\u00e9s, nous pouvons maintenant configurer Spring Security pour utiliser ces composants.</p> <pre><code>@Configuration\n@EnableWebSecurity\npublic class SpringSecurityConfig {\n\n    @Autowired\n    private JwtAuthenticationFilter jwtAuthenticationFilter;\n\n    @Autowired\n    private UserService userService;\n\n    @Autowired\n    private CorsConfig corsConfigurationSource;\n\n    @Bean\n    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {\n        http\n                .csrf(AbstractHttpConfigurer::disable)\n                .cors(cors -&gt; cors.configurationSource(corsConfigurationSource))\n                .authorizeHttpRequests(auth -&gt; auth\n                        .requestMatchers(\n                                \"/\",\n                                \"/api/auth/**\",\n                                \"/swagger-ui.html\",\n                                \"/swagger-ui/**\",\n                                \"/v3/api-docs/**\",\n                                \"/error\"\n                        ).permitAll()\n                        .anyRequest().authenticated()\n                )\n                .sessionManagement(session -&gt; session\n                        .sessionCreationPolicy(SessionCreationPolicy.STATELESS)\n                )\n                .authenticationProvider(authenticationProvider())\n                .addFilterBefore(jwtAuthenticationFilter, UsernamePasswordAuthenticationFilter.class);\n\n        return http.build();\n    }\n\n    @Bean\n    public AuthenticationProvider authenticationProvider() {\n        DaoAuthenticationProvider authProvider = new DaoAuthenticationProvider(userService);\n        authProvider.setPasswordEncoder(passwordEncoder());\n        return authProvider;\n    }\n\n    @Bean\n    public PasswordEncoder passwordEncoder() {\n        return new BCryptPasswordEncoder();\n    }\n\n    @Bean\n    public AuthenticationManager authenticationManager(AuthenticationConfiguration config) throws Exception {\n        return config.getAuthenticationManager();\n    }\n}\n</code></pre>"},{"location":"sequences/s3/security/creation_configuration/#explications_2","title":"Explications","text":""},{"location":"sequences/s3/security/creation_configuration/#attributs_1","title":"Attributs","text":"<ul> <li><code>JwtAuthenticationFilter</code> : Le filtre JWT que nous avons cr\u00e9\u00e9 pr\u00e9c\u00e9demment pour intercepter les requ\u00eates et valider les tokens.</li> <li><code>UserService</code> : Le service pour charger les d\u00e9tails de l'utilisateur.</li> <li><code>CorsConfig</code> : La configuration CORS que nous avons cr\u00e9\u00e9e pr\u00e9c\u00e9demment.</li> </ul>"},{"location":"sequences/s3/security/creation_configuration/#methode-filterchain","title":"M\u00e9thode <code>filterChain</code>","text":"<p>Cette m\u00e9thode configure la cha\u00eene de filtres de s\u00e9curit\u00e9 pour l'application. Ainsi, pour une requ\u00eate entrante, elle va :</p> <ul> <li>D\u00e9sactiver la protection CSRF (Cross-Site Request Forgery) car nous utilisons des tokens JWT.</li> <li>Configurer CORS en utilisant la configuration d\u00e9finie dans <code>CorsConfig</code>.</li> <li>D\u00e9finir les r\u00e8gles d'autorisation des requ\u00eates HTTP :</li> <li>Les endpoints <code>/</code>, <code>/api/auth/**</code>, <code>/swagger-ui.html</code>, <code>/swagger-ui/**</code>, <code>/v3/api-docs/**</code> et <code>/error</code> sont accessibles sans authentification.</li> <li>Toutes les autres requ\u00eates n\u00e9cessitent une authentification.</li> <li>Configurer la gestion des sessions pour qu'elle soit sans \u00e9tat (STATELESS), ce qui est appropri\u00e9 pour les applications utilisant des tokens JWT.</li> <li>D\u00e9finir le fournisseur d'authentification en utilisant la m\u00e9thode <code>authenticationProvider()</code>.</li> <li>Ajouter le filtre JWT avant le filtre <code>UsernamePasswordAuthenticationFilter</code> pour s'assurer que les tokens sont valid\u00e9s avant toute tentative d'authentification.</li> </ul>"},{"location":"sequences/s3/security/creation_configuration/#methode-authenticationprovider","title":"M\u00e9thode <code>authenticationProvider</code>","text":"<p>Cette m\u00e9thode cr\u00e9e un <code>DaoAuthenticationProvider</code> qui utilise le <code>UserService</code> pour charger les d\u00e9tails de l'utilisateur et un <code>PasswordEncoder</code> pour encoder les mots de passe.</p>"},{"location":"sequences/s3/security/creation_configuration/#methode-passwordencoder","title":"M\u00e9thode <code>passwordEncoder</code>","text":"<p>Cette m\u00e9thode cr\u00e9e un <code>BCryptPasswordEncoder</code> pour encoder les mots de passe de mani\u00e8re s\u00e9curis\u00e9e.</p>"},{"location":"sequences/s3/security/creation_configuration/#methode-authenticationmanager","title":"M\u00e9thode <code>authenticationManager</code>","text":"<p>Cette m\u00e9thode cr\u00e9e un <code>AuthenticationManager</code> en utilisant la configuration d'authentification fournie par Spring. Celui-ci sera utilis\u00e9 dans le contr\u00f4leur d'authentification pour g\u00e9rer le processus d'authentification des utilisateurs.</p>"},{"location":"sequences/s3/security/creation_jwt/","title":"Configuration des token JWT","text":"<p>Nous allons cr\u00e9er un service d\u00e9di\u00e9 \u00e0 la gestion des tokens JWT. Ce service sera responsable de la g\u00e9n\u00e9ration, de la validation et de l'extraction des informations contenues dans les tokens.</p> <p>Dans le dossier <code>service</code>, cr\u00e9ez une nouvelle classe <code>JwtService.java</code> :</p>"},{"location":"sequences/s3/security/creation_jwt/#attributs","title":"Attributs","text":"<p>Premi\u00e8rement, nous allons d\u00e9finir les attributs n\u00e9cessaires pour la gestion des tokens JWT, tels que le secret de signature et les dur\u00e9es d'expiration.</p> <pre><code>@Value(\"${jwt.secret}\")\nprivate String secret;\n\n@Value(\"${jwt.expiration}\")\nprivate Long expiration;\n\n@Value(\"${jwt.refresh.expiration:604800000}\")\nprivate Long refreshExpiration;\n</code></pre> <p>L'annotation <code>@Value</code> permet d'injecter les valeurs d\u00e9finies dans le fichier <code>application.properties</code>. Ainsi, pour modifier facilement les param\u00e8tres des tokens, vous pouvez ajouter les lignes suivantes dans <code>application.properties</code> :</p> <pre><code>jwt.secret=VotreCl\u00e9Secr\u00e8teIciBase64Encod\u00e9e\njwt.expiration=3600000  # 1 heure en millisecondes\njwt.refresh.expiration=604800000  # 7 jours en millisecondes\n</code></pre>"},{"location":"sequences/s3/security/creation_jwt/#methodes","title":"M\u00e9thodes","text":"<p>Nous allons maintenant impl\u00e9menter les m\u00e9thodes n\u00e9cessaires pour g\u00e9n\u00e9rer, valider et extraire les informations des tokens JWT.</p> <pre><code>private SecretKey getSigningKey() {\n    byte[] keyBytes = Decoders.BASE64.decode(secret);\n    return Keys.hmacShaKeyFor(keyBytes);\n}\n\npublic String generateToken(UserDetails userDetails) {\n    Map&lt;String, Object&gt; claims = new HashMap&lt;&gt;();\n    claims.put(\"roles\", userDetails.getAuthorities());\n    return createToken(claims, userDetails.getUsername(), expiration);\n}\n\npublic String generateRefreshToken(UserDetails userDetails) {\n    Map&lt;String, Object&gt; claims = new HashMap&lt;&gt;();\n    claims.put(\"type\", \"refresh\");\n    return createToken(claims, userDetails.getUsername(), refreshExpiration);\n}\n\nprivate String createToken(Map&lt;String, Object&gt; claims, String subject, Long expirationTime) {\n    Date now = new Date();\n    Date expiryDate = new Date(now.getTime() + expirationTime);\n\n    return Jwts.builder()\n            .claims(claims)\n            .subject(subject)\n            .issuedAt(now)\n            .expiration(expiryDate)\n            .signWith(getSigningKey())\n            .compact();\n}\n\npublic Boolean validateToken(String token, UserDetails userDetails) {\n    try {\n        final String username = extractUsername(token);\n        return (username.equals(userDetails.getUsername()) &amp;&amp; !isTokenExpired(token));\n    } catch (Exception e) {\n        return false;\n    }\n}\n\npublic Boolean validateRefreshToken(String token) {\n    try {\n        Claims claims = extractAllClaims(token);\n        String type = claims.get(\"type\", String.class);\n        return \"refresh\".equals(type) &amp;&amp; !isTokenExpired(token);\n    } catch (Exception e) {\n        return false;\n    }\n}\n\n\npublic String extractUsername(String token) {\n    return extractClaim(token, Claims::getSubject);\n}\n\npublic Date extractExpiration(String token) {\n    return extractClaim(token, Claims::getExpiration);\n}\n\npublic &lt;T&gt; T extractClaim(String token, Function&lt;Claims, T&gt; claimsResolver) {\n    final Claims claims = extractAllClaims(token);\n    return claimsResolver.apply(claims);\n}\n\nprivate Claims extractAllClaims(String token) {\n    return Jwts.parser()\n            .verifyWith(getSigningKey())\n            .build()\n            .parseSignedClaims(token)\n            .getPayload();\n}\n\nprivate Boolean isTokenExpired(String token) {\n    return extractExpiration(token).before(new Date());\n}\n\npublic Long getExpirationTime() {\n    return expiration;\n}\n\npublic Long getRefreshExpirationTime() {\n    return refreshExpiration;\n}\n</code></pre> <p>Ici, nous utilisons la biblioth\u00e8que <code>jjwt</code> dans sa version 13.0 pour manipuler les tokens JWT. Assurez-vous d'ajouter la d\u00e9pendance suivante dans votre fichier <code>pom.xml</code> si ce n'est pas d\u00e9j\u00e0 fait :</p> <pre><code>\n&lt;dependency&gt;\n    &lt;groupId&gt;io.jsonwebtoken&lt;/groupId&gt;\n    &lt;artifactId&gt;jjwt-api&lt;/artifactId&gt;\n    &lt;version&gt;0.13.0&lt;/version&gt;\n&lt;/dependency&gt;\n\n&lt;dependency&gt;\n    &lt;groupId&gt;io.jsonwebtoken&lt;/groupId&gt;\n    &lt;artifactId&gt;jjwt-impl&lt;/artifactId&gt;\n    &lt;version&gt;0.13.0&lt;/version&gt;\n    &lt;scope&gt;runtime&lt;/scope&gt;\n&lt;/dependency&gt;\n</code></pre>"},{"location":"sequences/s3/security/preface_configuration/","title":"Configuration de Spring Security - Avant de commencer","text":""},{"location":"sequences/s3/security/preface_configuration/#gestion-de-la-securite-avec-spring-security","title":"Gestion de la s\u00e9curit\u00e9 avec Spring Security","text":"<p>Une fois le service JWT mis en place, nous allons configurer la s\u00e9curit\u00e9 de notre application en utilisant Spring Security.</p> <p>Pour ce faire, nous allons mettre \u00e0 jour la configuration de Spring Security afin d'int\u00e9grer notre filtre d'authentification JWT.</p> <p>Le fonctionnement de Spring Security repose sur une cha\u00eene de filtres qui interceptent les requ\u00eates HTTP entrantes.</p> <p>Nous allons ajouter notre <code>JwtAuthenticationFilter</code> \u00e0 cette cha\u00eene pour qu'il puisse traiter les tokens JWT avant que les requ\u00eates n'atteignent les contr\u00f4leurs.</p>"},{"location":"sequences/s3/security/preface_jwt/","title":"Configuration des token JWT - Avant de commencer","text":""},{"location":"sequences/s3/security/preface_jwt/#gestion-des-token-jwt","title":"Gestion des token JWT","text":"<p>Afin de g\u00e9rer l'authentification stateless<sup>1</sup> de notre application, nous allons utiliser des JSON Web Tokens (JWT). </p> <p>Les tokens JWT permettent de transmettre des informations s\u00e9curis\u00e9es entre le client et le serveur sous forme de JSON. Ils sont sign\u00e9s num\u00e9riquement pour garantir leur int\u00e9grit\u00e9 et peuvent \u00eatre v\u00e9rifi\u00e9s par le serveur sans avoir besoin de stocker une session.</p> <p>Ainsi, chaque requ\u00eate envoy\u00e9e au serveur doit inclure un token JWT valide dans les en-t\u00eates HTTP de la requ\u00eate, g\u00e9n\u00e9ralement dans l'en-t\u00eate <code>Authorization</code> :</p> <p><code>Authorization: Bearer &lt;token_JWT&gt;</code></p> <p>Le serveur peut alors v\u00e9rifier ce token pour authentifier l'utilisateur et autoriser l'acc\u00e8s aux ressources prot\u00e9g\u00e9es.</p>"},{"location":"sequences/s3/security/preface_jwt/#schema-du-token-jwt","title":"Sch\u00e9ma du token JWT","text":"<ol> <li>Statless signifie que le serveur ne conserve pas d'\u00e9tat de session entre les requ\u00eates. Chaque requ\u00eate est autonome et doit contenir toutes les informations n\u00e9cessaires pour \u00eatre trait\u00e9e.</li> </ol>"},{"location":"sequences/s4/","title":"Connexion d\u2019un client au SSO","text":"<p>Cette section va expliquer les \u00e9tapes n\u00e9cessaires pour qu\u2019un client (application web) puisse s\u2019authentifier aupr\u00e8s du serveur SSO que nous avons mis en place pr\u00e9c\u00e9demment.</p>"},{"location":"sequences/s4/#1-informations-necessaires-cote-client","title":"1. Informations n\u00e9cessaires c\u00f4t\u00e9 client","text":"<p>Quand un utilisateur clique sur \u201cSe connecter\u201d, l\u2019application cliente ne g\u00e8re jamais le login elle-m\u00eame. Elle doit rediriger l\u2019utilisateur vers le serveur SSO gr\u00e2ce \u00e0 une URL contenant des param\u00e8tres obligatoires :</p> <ul> <li>client_id : l\u2019identifiant du client </li> <li>redirect_uri : l\u2019URL vers laquelle ton SSO renverra l\u2019utilisateur apr\u00e8s validation</li> <li>authorization_endpoint : l\u2019URL du serveur SSO pour l\u2019autorisation</li> <li>response_type=code : car on utilise un code d\u2019autorisation</li> </ul> <p>\u00e9ventuellement scope si tu veux g\u00e9rer des permissions</p> <p>Exemple d\u2019URL :</p> <p>https://sso.example.com/authorize?client_id=mon-client&amp;redirect_uri=https://monapp.example.com/callback&amp;response_type=code</p> <p>Voici donc ce que nous allons mettre en place.</p> <p>Pour ce faire, nous allons donc cr\u00e9er 2 applications web comme nous avons pu le voir dans la vid\u00e9o :</p> <ul> <li>Une application administrative connect\u00e9e au serveur SSO</li> <li>Une application cliente qui va permettre \u00e0 l\u2019utilisateur de se connecter via le serveur SSO</li> </ul>"},{"location":"sequences/s4/admin/","title":"Cr\u00e9ation d'une application React li\u00e9e au SSO","text":""},{"location":"sequences/s4/admin/#structure-du-projet","title":"Structure du projet","text":"<p>Pour initialiser le projet React, nous allons utiliser Vite, un outil de build rapide et moderne pour les applications web. Pour se faire, ex\u00e9cutez la commande suivante dans votre terminal :</p> <pre><code>npm create vite@latest\n</code></pre> <p>Choisissez le nom du projet (par exemple, <code>frontend</code>) et s\u00e9lectionnez <code>React</code> comme framework. Pour le language, vous pouvez choisir entre JavaScript et TypeScript selon vos pr\u00e9f\u00e9rences. Ici, nous utiliserons JavaScript.</p>"},{"location":"sequences/s4/admin/#structure-des-dossiers","title":"Structure des dossiers","text":"<p>Voici donc un exemple de structure de projet pour notre application React :</p> <pre><code>/frontend\n  |-- /public\n      |-- favicon.ico\n  |-- /src\n      |-- /api\n          |-- index.js\n          |-- Urls.js\n      |-- /components\n          |-- common\n              |-- Table.jsx\n          |-- layout\n              |-- Header.jsx\n              |-- Footer.jsx\n              |-- Sidebar.jsx\n      |-- /pages\n          |-- auth\n              |-- ForgetPassword.jsx\n              |-- Login.jsx\n              |-- Register.jsx\n          |-- clients\n              |-- Clients.jsx\n          |-- companies\n              |-- Companies.jsx\n          |-- dasboard\n              |-- Dashboard.jsx\n          |-- home\n              |-- Home.jsx\n          |-- logs\n              |-- Logs.jsx\n          |-- plans\n              |-- Plans.jsx\n          |-- realms\n              |-- Realms.jsx\n          |-- roles\n              |-- Roles.jsx\n          |-- settings\n              |-- profile\n                  |-- notifications\n                      |-- ProfileNotifications.jsx\n                  |-- preferences\n                      |-- ProfilePreferences.jsx\n                  |-- settings\n                      |-- ProfileSettings.jsx\n                  |-- security\n                      |-- ProfileSecurity.jsx\n              |-- realm\n                  |-- RealmSettings.jsx\n          |-- users\n              |-- Users.jsx\n      |-- /styles\n          |-- global.css\n      |-- App.jsx\n      |-- AuthProvider.jsx\n      |-- main.jsx\n  |-- .gitignore\n  |-- .env\n  |-- eslint.config.js\n  |-- package.json\n  |-- README.md\n  |-- vite.config.js\n</code></pre>"},{"location":"sequences/s4/admin/#routes-de-lapplication","title":"Routes de l'application","text":"<p>Pour simplifier le projet, nous allons nous concentrer uniquement sur le fichier <code>App.jsx</code> pour le moment. Le fichier <code>App.jsx</code> sera le router principal de notre application React. Voici donc les routes qu'il faudra impl\u00e9menter :</p> <pre><code>/ # Page d'accueil du SSO\n/auth/login/{realmName} # Page de connexion\n/auth/register # Page d'inscription\n/auth/forgot-password # Page de r\u00e9initialisation du mot de passe\n/realm/{realmName} # Page du realm\n    /dashboard                       # Tableau de bord du realm\n    /users                           # Liste des realms\n    /clients                         # Liste des clients du realm\n    /users                           # Liste des utilisateurs du realm\n    /roles                           # Liste des r\u00f4les du realm\n    /plans                           # Liste des plans du SSO\n    /companies                       # Liste des entreprises\n    /logs                            # Page des logs\n    /settings                        # Page des param\u00e8tres\n\n    # Si vous voulez aller plus loin, vous pouvez \u00e9galement cr\u00e9er ces pages :\n    /profile                         # Page de profil utilisateur\n    /settings                        # Page des param\u00e8tres utilisateur\n        /profile                     # Param\u00e8tres de profil\n        /preferences                 # Pr\u00e9f\u00e9rences utilisateur\n        /notifications               # Param\u00e8tres de notifications\n        /security                    # Param\u00e8tres de s\u00e9curit\u00e9\n</code></pre> <p>Ces pages sont le strict minimum pour notre application SSO, en sachant que toutes les pages ne seront pas visibles en fonction des r\u00f4les de la personne connect\u00e9e.</p>"},{"location":"sequences/s4/admin/#gestion-des-roles","title":"Gestion des r\u00f4les","text":"<p>Comme on l'a vu auparavant, notre SSO utilise des r\u00f4les pour les utilisateurs :</p> <pre><code>- SUPER_ADMIN : System-wide administrator with highest privileges\n- ADMIN : Realm administrator with elevated privileges\n- USER : Standard user with limited access\n- REALM_ADMIN : Realm owner and manager\n</code></pre> <p>Il faut donc adapter l'affichage des pages en fonction des r\u00f4les de l'utilisateur connect\u00e9. C'est pour cela que l'on a notre fichier <code>Sidebar.jsx</code> qui va permettre cela en affichant les liens de navigation appropri\u00e9s selon les r\u00f4les.</p>"},{"location":"sequences/s4/admin/#exercice","title":"Exercice","text":"<ol> <li>Initialisez un projet React avec Vite en utilisant la commande <code>npm create vite@latest</code>.</li> <li>Cr\u00e9ez la structure de dossiers d\u00e9crite ci-dessus.</li> <li>Impl\u00e9mentez les routes dans le fichier <code>App.jsx</code>.</li> <li>Cr\u00e9ez les diff\u00e9rentes pages dans le dossier <code>pages</code> en respectant la structure donn\u00e9e.</li> <li>Adaptez l'affichage des pages en fonction des r\u00f4les de l'utilisateur connect\u00e9</li> </ol>"},{"location":"sequences/s4/admin/#correction-de-lexercice","title":"Correction de l'exercice","text":"<p>Voici une correction possible pour l'exercice propos\u00e9 :</p> <ul> <li>Code source de l'application React</li> </ul>"},{"location":"sequences/s4/admin/modification/","title":"Modification du syst\u00e8me d'authentification","text":"<p>Dans cette section, nous allons modifier le service d'authentification pour permettre la gestion des connexions clients. Actuellement, notre syst\u00e8me d'authentification est configur\u00e9 de fa\u00e7on a permettre la connexion \u00e0 une application peu importe le r\u00f4le de l'utilisateur.</p> <p>Voici donc les fichiers que nous allons modifier pour impl\u00e9menter cette fonctionnalit\u00e9 :</p> <ul> <li><code>AuthController.java</code> : Nous allons modifier l\u00e9g\u00e8rement la m\u00e9thode <code>login</code> pour v\u00e9rifier les permissions d'un utilisateur lors de la connexion \u00e0 un client \u00e0 travers son realm.</li> <li><code>AuthService.java</code> : Nous allons rajouter une m\u00e9thode <code>testUser</code> pour v\u00e9rifier si l'utilisateur a le droit de se connecter au client.</li> </ul> <p>Maintenant que nous avons modifi\u00e9 notre service d'authentification, nous allons pouvoir cr\u00e9er nos applications.</p>"},{"location":"sequences/s4/client/","title":"Cr\u00e9ation d'une application React consommant le SSO","text":"<p>Dans cette section, nous allons cr\u00e9er une application cliente en React qui consommera le service d'authentification SSO que nous avons mis en place pr\u00e9c\u00e9demment.</p>"},{"location":"sequences/s4/client/#structure-du-projet","title":"Structure du projet","text":"<p>Pour initialiser le projet React, nous allons utiliser Vite, un outil de build rapide et moderne pour les applications web. Pour se faire, ex\u00e9cutez la commande suivante dans votre terminal :</p> <pre><code>npm create vite@latest\n</code></pre> <p>Choisissez le nom du projet (par exemple, <code>client-app</code>) et s\u00e9lectionnez <code>React</code> comme framework. Pour le language, vous pouvez choisir entre JavaScript et TypeScript selon vos pr\u00e9f\u00e9rences. Ici, nous utiliserons JavaScript.</p> <p>Voici un exemple de structure de projet pour notre application React :</p> <pre><code>/client-app\n  |-- /public\n      |-- favicon.ico\n  |-- /src\n      |-- /components\n            |-- LoginButton.jsx\n      |-- /pages\n            |-- Home.jsx\n            |-- Dashboard.jsx\n            |-- Login.jsx\n            |-- Profile.jsx\n      |-- App.jsx\n      |-- main.jsx\n  |-- .gitignore\n  |-- .env\n  |-- eslint.config.js\n  |-- package.json\n  |-- README.md\n  |-- vite.config.js\n</code></pre> <p>Le but de cette application est de simuler un client web qui s'authentifie via le serveur SSO que nous avons cr\u00e9\u00e9. Pour ce faire, nous allons cr\u00e9er plusieurs pages : une page d'accueil, une page de connexion, un tableau de bord et une page de profil utilisateur.</p>"},{"location":"sequences/s4/client/#exercice","title":"Exercice","text":"<ol> <li>Initialisation du projet : Cr\u00e9ez un nouveau projet React avec Vite comme d\u00e9crit ci-dessus.</li> <li>Cr\u00e9er le composant LoginButton : Ce bouton permettra \u00e0 l'utilisateur de se connecter via le SSO. Lorsqu'il est    cliqu\u00e9, il redirigera l'utilisateur vers le serveur d'authentification SSO en fonction des param\u00e8tres OAuth2.</li> <li>Cr\u00e9er les pages :<ul> <li><code>Home.jsx</code> : La page d'accueil de l'application.</li> <li><code>Login.jsx</code> : La page de connexion qui affichera le bouton de connexion SSO.</li> <li><code>Dashboard.jsx</code> : La page principale apr\u00e8s la connexion, affichant des informations utilisateur.</li> <li><code>Profile.jsx</code> : Une page pour afficher et modifier les informations du profil utilisateur.</li> </ul> </li> <li>Gestion des routes : Utilisez <code>react-router-dom</code> pour g\u00e9rer la navigation entre les diff\u00e9rentes pages de    l'application.</li> <li>Int\u00e9gration avec le SSO : Configurez l'application pour qu'elle interagisse avec le serveur SSO pour    l'authentification.<ul> <li>Lorsqu'un utilisateur clique sur le bouton de connexion, il doit \u00eatre redirig\u00e9 vers le serveur SSO.</li> <li>Apr\u00e8s une authentification r\u00e9ussie, l'utilisateur doit \u00eatre redirig\u00e9 vers le tableau de bord avec un token JWT.</li> </ul> </li> <li>Affichage des informations utilisateur : Sur la page <code>Dashboard.jsx</code>, affichez les informations de l'utilisateur    r\u00e9cup\u00e9r\u00e9es \u00e0 partir du token JWT.</li> <li>Gestion de la d\u00e9connexion : Ajoutez une fonctionnalit\u00e9 de d\u00e9connexion qui r\u00e9voque le token JWT et redirige    l'utilisateur vers la page d'accueil.</li> <li>Testez l'application : Assurez-vous que toutes les fonctionnalit\u00e9s fonctionnent correctement, y compris    la redirection vers le SSO, la r\u00e9cup\u00e9ration des informations utilisateur et la d\u00e9connexion.</li> </ol>"},{"location":"sequences/s4/clients/js/","title":"Cr\u00e9ation d'un client JavaScript consommant le SSO","text":""},{"location":"sequences/s4/clients/js/#structure-du-projet","title":"Structure du projet","text":"<p>Le client JavaScript est structur\u00e9 de mani\u00e8re simple avec un seul fichier HTML:</p> <pre><code>/client-js\n  |-- index.html          # Page HTML principale\n</code></pre>"},{"location":"sequences/s4/clients/react/","title":"Cr\u00e9ation d'un client React consommant le SSO","text":""},{"location":"sequences/s4/clients/react/#structure-du-projet","title":"Structure du projet","text":"<p>Pour initialiser le projet React, nous allons utiliser Vite, un outil de build rapide et moderne pour les applications web. La structure du projet sera la suivante :</p> <p>Pour se faire, ex\u00e9cutez la commande suivante dans votre terminal :</p> <pre><code>npm create vite@latest\n</code></pre> <p>Choisissez le nom du projet (par exemple, <code>client-react</code>) et s\u00e9lectionnez <code>React</code> comme framework. Pour le language, vous pouvez choisir entre JavaScript et TypeScript selon vos pr\u00e9f\u00e9rences. Ici, nous utiliserons JavaScript.</p> <p>Une fois le projet cr\u00e9\u00e9, la structure sera la suivante :</p> <pre><code>/client-react\n  |-- /public               # Fichiers publics (index.html, favicon, etc.)\n  |-- /src                  # Code source de l'application\n      |-- /assets           # Ressources statiques (images, styles, etc.)\n      |-- App.css           # Styles globaux de l'application\n      |-- App.jsx           # Composant principal de l'application\n      |-- index.css         # Styles sp\u00e9cifiques \u00e0 l'index\n      |-- main.jsx          # Point d'entr\u00e9e de l'application\n  |-- .gitignore            # Fichier pour ignorer certains fichiers dans Git\n  |-- eslint.config.js      # Configuration ESLint\n  |-- index.html            # Fichier HTML principal\n  |-- package.json          # Fichier de configuration npm\n  |-- README.md             # Documentation du projet\n  |-- vite.config.js        # Configuration de Vite\n</code></pre>"},{"location":"sequences/s4/clients/react/#simplification-du-projet","title":"Simplification du projet","text":"<p>Pour simplifier notre exemple, nous allons nous concentrer uniquement sur le fichier <code>App.jsx</code>.</p>"}]}